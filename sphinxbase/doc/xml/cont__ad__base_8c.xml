<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.6">
  <compounddef id="cont__ad__base_8c" kind="file">
    <compoundname>cont_ad_base.c</compoundname>
    <includes local="no">stdio.h</includes>
    <includes local="no">stdlib.h</includes>
    <includes local="no">string.h</includes>
    <includes refid="assert_8h" local="no">assert.h</includes>
    <includes local="no">math.h</includes>
    <includes refid="prim__type_8h" local="yes">sphinxbase/prim_type.h</includes>
    <includes refid="ad_8h" local="yes">sphinxbase/ad.h</includes>
    <includes refid="cont__ad_8h" local="yes">sphinxbase/cont_ad.h</includes>
    <includes refid="err_8h" local="yes">sphinxbase/err.h</includes>
    <incdepgraph>
      <node id="1263">
        <label>stdarg.h</label>
      </node>
      <node id="1255">
        <label>assert.h</label>
        <link refid="assert_8h_source"/>
      </node>
      <node id="1264">
        <label>errno.h</label>
        <link refid="errno_8h_source"/>
      </node>
      <node id="1253">
        <label>stdlib.h</label>
      </node>
      <node id="1259">
        <label>sphinxbase/ad.h</label>
        <link refid="ad_8h"/>
        <childnode refid="1258" relation="include">
        </childnode>
        <childnode refid="1260" relation="include">
        </childnode>
        <childnode refid="1257" relation="include">
        </childnode>
      </node>
      <node id="1258">
        <label>sphinx_config.h</label>
      </node>
      <node id="1254">
        <label>string.h</label>
      </node>
      <node id="1260">
        <label>sphinxbase/sphinxbase_export.h</label>
        <link refid="sphinxbase__export_8h_source"/>
      </node>
      <node id="1257">
        <label>sphinxbase/prim_type.h</label>
        <link refid="prim__type_8h"/>
        <childnode refid="1258" relation="include">
        </childnode>
      </node>
      <node id="1256">
        <label>math.h</label>
      </node>
      <node id="1261">
        <label>sphinxbase/cont_ad.h</label>
        <link refid="cont__ad_8h"/>
        <childnode refid="1260" relation="include">
        </childnode>
        <childnode refid="1257" relation="include">
        </childnode>
        <childnode refid="1259" relation="include">
        </childnode>
        <childnode refid="1252" relation="include">
        </childnode>
      </node>
      <node id="1251">
        <label>src/libsphinxad/cont_ad_base.c</label>
        <link refid="cont_ad_base.c"/>
        <childnode refid="1252" relation="include">
        </childnode>
        <childnode refid="1253" relation="include">
        </childnode>
        <childnode refid="1254" relation="include">
        </childnode>
        <childnode refid="1255" relation="include">
        </childnode>
        <childnode refid="1256" relation="include">
        </childnode>
        <childnode refid="1257" relation="include">
        </childnode>
        <childnode refid="1259" relation="include">
        </childnode>
        <childnode refid="1261" relation="include">
        </childnode>
        <childnode refid="1262" relation="include">
        </childnode>
      </node>
      <node id="1262">
        <label>sphinxbase/err.h</label>
        <link refid="err_8h"/>
        <childnode refid="1263" relation="include">
        </childnode>
        <childnode refid="1252" relation="include">
        </childnode>
        <childnode refid="1253" relation="include">
        </childnode>
        <childnode refid="1264" relation="include">
        </childnode>
        <childnode refid="1260" relation="include">
        </childnode>
      </node>
      <node id="1252">
        <label>stdio.h</label>
      </node>
    </incdepgraph>
      <sectiondef kind="define">
      <memberdef kind="define" id="cont__ad__base_8c_1a6dc732b0957d4d4f8dd3e7f0b5cace7f" prot="public" static="no">
        <name>_ABS</name>
        <param><defname>x</defname></param>
        <initializer>((x) &gt;= 0 ? (x) : -(x))</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="175" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="175" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cont__ad__base_8c_1aef9feb706c9961138244b9cc04d59817" prot="public" static="no">
        <name>CONT_AD_ADFRMSIZE</name>
        <initializer>256     /* #Frames of internal A/D buffer maintained */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="181" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="181" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cont__ad__base_8c_1a8e0fa5870bce6ca255f29dbb105262d4" prot="public" static="no">
        <name>CONT_AD_POWHISTSIZE</name>
        <initializer>98      /* #Powhist bins: ~ FRMPOW(65536^2*CONT_AD_SPF) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="183" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="183" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cont__ad__base_8c_1a06e46861cac0bac76838f9da40b45901" prot="public" static="no">
        <name>CONT_AD_CALIB_FRAMES</name>
        <initializer>(CONT_AD_POWHISTSIZE * 2)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="186" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="186" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cont__ad__base_8c_1a7803030b504af9ec2b9deac53d7bd4e5" prot="public" static="no">
        <name>CONT_AD_THRESH_UPDATE</name>
        <initializer>100     /* Update thresholds approx every so many frames */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="188" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="188" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cont__ad__base_8c_1a0127ba8edd6cfb671e33ae64a33047e6" prot="public" static="no">
        <name>CONT_AD_ADAPT_RATE</name>
        <initializer>0.2     /* Interpolation of new and old noiselevel */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="191" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="191" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cont__ad__base_8c_1a2bb801bcc7d1a846a81c347df5f1fd3d" prot="public" static="no">
        <name>CONT_AD_SPS</name>
        <initializer>16000</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="193" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="193" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cont__ad__base_8c_1a786306be9664276033f7e8794d993bd3" prot="public" static="no">
        <name>CONT_AD_DEFAULT_NOISE</name>
        <initializer>30      /* Default background noise power level */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="195" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="195" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cont__ad__base_8c_1a0e66aa6314ff813688e06008ffd94cd4" prot="public" static="no">
        <name>CONT_AD_DELTA_SIL</name>
        <initializer>10      /* Initial default for <ref refid="structcont__ad__t_1a74a6f56fb4cbde7fc789c9b463cf2f8f" kindref="member">cont_ad_t.delta_sil</ref> */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="196" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="196" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cont__ad__base_8c_1ad812c16c39fd409e729eeda135c16bb4" prot="public" static="no">
        <name>CONT_AD_DELTA_SPEECH</name>
        <initializer>17      /* Initial default for <ref refid="structcont__ad__t_1afca0f69a21d9f28c9610fcefc0e7cb10" kindref="member">cont_ad_t.delta_speech</ref> */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="197" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="197" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cont__ad__base_8c_1a9e44b44fc3371c0693db7893e0222ee8" prot="public" static="no">
        <name>CONT_AD_MIN_NOISE</name>
        <initializer>2       /* Expected minimum background noise level */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="198" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="198" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cont__ad__base_8c_1a3315dad6a635eb957696aea05e057ba7" prot="public" static="no">
        <name>CONT_AD_MAX_NOISE</name>
        <initializer>70      /* Maximum background noise level */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="199" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="199" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cont__ad__base_8c_1aeac4ca76a236c666e5d782b1dbe200f9" prot="public" static="no">
        <name>CONT_AD_HIST_INERTIA</name>
        <initializer>3       /* Used in decaying the power histogram */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="201" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="201" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cont__ad__base_8c_1a30b943edf12178d749bb60c0b9a080ed" prot="public" static="no">
        <name>CONT_AD_WINSIZE</name>
        <initializer>21      /* Analysis window for state transitions */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="203" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="203" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cont__ad__base_8c_1a2eaf5e77d8b4c11a08df2371c578a660" prot="public" static="no">
        <name>CONT_AD_SPEECH_ONSET</name>
        <initializer>9       /* Min #speech frames in analysis window for
                                           SILENCE -&gt; SPEECH state transition */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="207" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="206" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cont__ad__base_8c_1aad657b0ecd80d6bfd6e18acd17b8ec86" prot="public" static="no">
        <name>CONT_AD_SIL_ONSET</name>
        <initializer>18      /* Min #silence frames in analysis window for
                                           SPEECH -&gt; SILENCE state transition
                                           MUST BE &lt;= CONT_AD_WINSIZE */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="215" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="213" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cont__ad__base_8c_1aa7a0260468ba7393925c923f01796fc7" prot="public" static="no">
        <name>CONT_AD_LEADER</name>
        <initializer>5       /* On transition to SPEECH state, so many frames
                                           BEFORE window included in speech data (&gt;0) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="221" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="220" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="cont__ad__base_8c_1ab109a6cc79a80fc155ef170ddbc66365" prot="public" static="no">
        <name>CONT_AD_TRAILER</name>
        <initializer>10      /* On transition to SILENCE state, so many frames
                                           of silence included in speech data (&gt;0).
                                           NOTE: Ensure (0 &lt; TRAILER+LEADER &lt;= WINSIZE) */</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="226" column="9" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="224" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="cont__ad__base_8c_1af9263171f620eed9e37efd3e116bc001" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void cont_ad_powhist_dump</definition>
        <argsstring>(FILE *fp, cont_ad_t *r)</argsstring>
        <name>cont_ad_powhist_dump</name>
        <param>
          <type>FILE *</type>
          <declname>fp</declname>
        </param>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>cont</declname>
          <defname>r</defname>
        </param>
        <briefdescription>
<para>Dump the power histogram. </para>        </briefdescription>
        <detaileddescription>
<para>For debugging... </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="231" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="231" bodyend="250"/>
        <references refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" compoundref="cont__ad_8h" startline="194">cont_ad_t::pow_hist</references>
        <references refid="structcont__ad__t_1a4ed32427e6a785b571b1346c85481899" compoundref="cont__ad_8h" startline="191">cont_ad_t::tot_frm</references>
        <references refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" compoundref="cont__ad_8h" startline="185">cont_ad_t::spf</references>
        <references refid="structcont__ad__t_1a11a4bb48870007b39f8fa46e4b8f111a" compoundref="cont__ad_8h" startline="180">cont_ad_t::sps</references>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a08e0f4817ddac82db61479c37e41b6ea" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 cont_ad_frame_pow</definition>
        <argsstring>(int16 *buf, int32 *prev, int32 spf)</argsstring>
        <name>cont_ad_frame_pow</name>
        <param>
          <type>int16 *</type>
          <declname>buf</declname>
        </param>
        <param>
          <type>int32 *</type>
          <declname>prev</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>spf</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="258" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="258" bodyend="304"/>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1abaa6c5c19178ca34f731e30898fdf633" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void compute_frame_pow</definition>
        <argsstring>(cont_ad_t *r, int32 frm)</argsstring>
        <name>compute_frame_pow</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>frm</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="312" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="312" bodyend="322"/>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1af7b7a7b0df75887906266c361470ec68" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void decay_hist</definition>
        <argsstring>(cont_ad_t *r)</argsstring>
        <name>decay_hist</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="331" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="331" bodyend="337"/>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a91f6a1390fa31c113b138b49bf7d16d7" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>static int32 find_thresh</definition>
        <argsstring>(cont_ad_t *r)</argsstring>
        <name>find_thresh</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="344" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="344" bodyend="406"/>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a6ee9d3e7346e14abf47c9a44ccc87c67" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void sil2speech_transition</definition>
        <argsstring>(cont_ad_t *r, int frm)</argsstring>
        <name>sil2speech_transition</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
        </param>
        <param>
          <type>int</type>
          <declname>frm</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="413" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="413" bodyend="458"/>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a1e9b6cef1521644f1d37d5fa5571cffc" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void speech2sil_transition</definition>
        <argsstring>(cont_ad_t *r, int frm)</argsstring>
        <name>speech2sil_transition</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
        </param>
        <param>
          <type>int</type>
          <declname>frm</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="464" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="464" bodyend="511"/>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a7d00e312b4753f058297e3f0a1c552c6" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void boundary_detect</definition>
        <argsstring>(cont_ad_t *r, int32 frm)</argsstring>
        <name>boundary_detect</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>frm</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="521" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="521" bodyend="588"/>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a3ac9fe23b7ebe2dea233d494b60b345d" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>static int32 max_siglvl</definition>
        <argsstring>(cont_ad_t *r, int32 startfrm, int32 nfrm)</argsstring>
        <name>max_siglvl</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>startfrm</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>nfrm</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="592" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="592" bodyend="606"/>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a1cd440b5db7d61b1438ef3ec771358a9" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>static void cont_ad_read_log</definition>
        <argsstring>(cont_ad_t *r, int32 retval)</argsstring>
        <name>cont_ad_read_log</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>retval</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="622" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="622" bodyend="651"/>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a14534ce1701646a046ab87b7065374a9" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>static int32 buf_copy</definition>
        <argsstring>(cont_ad_t *r, int32 sf, int32 nf, int16 *buf)</argsstring>
        <name>buf_copy</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>sf</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>nf</declname>
        </param>
        <param>
          <type>int16 *</type>
          <declname>buf</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="663" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="663" bodyend="704"/>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a9ab064c2a77c46a4af5ed3327869c73b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 cont_ad_buffer_space</definition>
        <argsstring>(cont_ad_t *r)</argsstring>
        <name>cont_ad_buffer_space</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
        </param>
        <briefdescription>
<para>Get the maximum number of samples which can be passed into <ref refid="cont__ad_8h_1ae664132adc514db01a1d5c1209ded4ba" kindref="member">cont_ad_read()</ref>. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="707" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="707" bodyend="710"/>
        <references refid="structcont__ad__t_1a5c6edc6be287f3ae013c59fef90cb4bd" compoundref="cont__ad_8h" startline="186">cont_ad_t::adbufsize</references>
        <references refid="structcont__ad__t_1a7ae5362560d9edfa6c16555285487a7a" compoundref="cont__ad_8h" startline="190">cont_ad_t::n_sample</references>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a5e0bf86d10d697d19cc23eae96c935d5" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>static int32 cont_ad_read_internal</definition>
        <argsstring>(cont_ad_t *r, int16 *buf, int32 max)</argsstring>
        <name>cont_ad_read_internal</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
        </param>
        <param>
          <type>int16 *</type>
          <declname>buf</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>max</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="716" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="716" bodyend="789"/>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a5e192b84b1516cbb9784d603b1beb624" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 cont_ad_classify</definition>
        <argsstring>(cont_ad_t *r, int32 len)</argsstring>
        <name>cont_ad_classify</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>len</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="795" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="795" bodyend="855"/>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a0e3ae880cc80eecdce6abcc4113d70ac" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 cont_ad_read</definition>
        <argsstring>(cont_ad_t *r, int16 *buf, int32 max)</argsstring>
        <name>cont_ad_read</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
          <briefdescription><para>In: Object pointer returned by cont_ad_init </para></briefdescription>
        </param>
        <param>
          <type>int16 *</type>
          <declname>buf</declname>
          <briefdescription><para>In/Out: In block mode, contains input data. On return, buf contains A/D data returned by this function, if any. </para></briefdescription>
        </param>
        <param>
          <type>int32</type>
          <declname>max</declname>
          <briefdescription><para>In: Maximum number of samples to be filled into buf. NOTE: max must be at least 256; otherwise the functions returns -1. </para></briefdescription>
        </param>
        <briefdescription>
<para>Read raw audio data into the silence filter. </para>        </briefdescription>
        <detaileddescription>
<para>The main read routine for reading speech/silence segmented audio data. Audio data is copied into the caller provided buffer, much like a file read routine.</para><para>In &quot;block mode&quot;, i.e. if NULL was passed as a read function to <computeroutput>cont_ad_init</computeroutput>, the data in <computeroutput>buf</computeroutput> is taken as input, and any non-silence data is written back to <computeroutput>buf</computeroutput> on exit. In this case, you must take care that <computeroutput>max</computeroutput> does not overflow the internal buffer of the silence filter. The available number of samples can be obtained by calling <ref refid="cont__ad_8h_1a680721acc14ac191bbae3a4940ed357d" kindref="member">cont_ad_buffer_space()</ref>. Any excess data will be discarded.</para><para>In normal mode, only speech segments are copied; silence segments are dropped. In rawmode (cont_ad module initialized using <ref refid="cont__ad_8h_1a1a9bbf961917827f5d03adcd409dda35" kindref="member">cont_ad_init_rawmode()</ref>), all data are passed through to the caller. But, in either case, any single call to cont_ad_read will never return data that crosses a speech/silence segment boundary.</para><para>The following variables are updated for use by the caller (see <ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> above): <ref refid="structcont__ad__t_1a5d9420ea711733d1eea9b8f29a638fdb" kindref="member">cont_ad_t.state</ref>, <ref refid="structcont__ad__t_1a7b71e87abfcb3ca4ae73af34c86f955e" kindref="member">cont_ad_t.read_ts</ref>, <ref refid="structcont__ad__t_1a478939247e09a8ae142c8996ec17d8c8" kindref="member">cont_ad_t.seglen</ref>, <ref refid="structcont__ad__t_1a5524c052dcd0a3d1a1c3b1fc2134b62e" kindref="member">cont_ad_t.siglvl</ref>.</para><para>Return value: Number of samples actually read, possibly 0; &lt;0 if EOF on A/D source. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="863" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="863" bodyend="1015"/>
        <references refid="err_8h_1a87a0a12135a290cf16d06b63fcfa0ccf" compoundref="err_8h" startline="121">E_ERROR</references>
        <references refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" compoundref="cont__ad_8h" startline="185">cont_ad_t::spf</references>
        <references refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" compoundref="cont__ad_8h" startline="231">cont_ad_t::logfp</references>
        <references refid="structcont__ad__t_1af7b9044b76ed3b86ce74e4e7215ca4c3" compoundref="cont__ad_8h" startline="183">cont_ad_t::eof</references>
        <references refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" compoundref="cont__ad_8h" startline="217">cont_ad_t::tail_state</references>
        <references refid="structcont__ad__t_1ac77e8f8bd27cea3b99238d9663455972" compoundref="cont__ad_8h" startline="225">cont_ad_t::spseg_tail</references>
        <references refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" compoundref="cont__ad_8h" startline="221">cont_ad_t::win_validfrm</references>
        <references refid="structcont__ad__t_1a7c61513f48e8fbc9ab6b57db66dad7b9" compoundref="cont__ad_8h" startline="202">cont_ad_t::winsize</references>
        <references refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" compoundref="cont__ad_8h" startline="220">cont_ad_t::win_startfrm</references>
        <references refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" compoundref="cont__ad_8h" startline="222">cont_ad_t::n_other</references>
        <references refid="structcont__ad__t_1abffe61140bc2a02ae4222183b3ef6159" compoundref="cont__ad_8h" startline="224">cont_ad_t::spseg_head</references>
        <references refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" compoundref="cont__ad_8h" startline="188">cont_ad_t::headfrm</references>
        <references refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" compoundref="cont__ad_8h" startline="189">cont_ad_t::n_frm</references>
        <references refid="structcont__ad__t_1a0d42e3ac6c1e5c59c86a40f4cf26a861" compoundref="cont__ad_8h" startline="205">cont_ad_t::leader</references>
        <references refid="structcont__ad__t_1a7726e8ea1bcca281a39c4b27bbb115e3" compoundref="cont__ad_8h" startline="156">cont_ad_t::rawmode</references>
        <references refid="structcont__ad__t_1a5524c052dcd0a3d1a1c3b1fc2134b62e" compoundref="cont__ad_8h" startline="175">cont_ad_t::siglvl</references>
        <references refid="structcont__ad__t_1a7ae5362560d9edfa6c16555285487a7a" compoundref="cont__ad_8h" startline="190">cont_ad_t::n_sample</references>
        <references refid="structcont__ad__t_1a5d9420ea711733d1eea9b8f29a638fdb" compoundref="cont__ad_8h" startline="165">cont_ad_t::state</references>
        <references refid="structcont__ad__t_1a478939247e09a8ae142c8996ec17d8c8" compoundref="cont__ad_8h" startline="171">cont_ad_t::seglen</references>
        <references refid="structcont__ad__t_1a7b71e87abfcb3ca4ae73af34c86f955e" compoundref="cont__ad_8h" startline="167">cont_ad_t::read_ts</references>
        <references refid="structcont__ad__t_1a4ed32427e6a785b571b1346c85481899" compoundref="cont__ad_8h" startline="191">cont_ad_t::tot_frm</references>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a4461f3a3b2cba93f1639f5806870a31f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 cont_ad_calib</definition>
        <argsstring>(cont_ad_t *r)</argsstring>
        <name>cont_ad_calib</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>cont</declname>
          <defname>r</defname>
          <briefdescription><para>In: object pointer returned by cont_ad_init </para></briefdescription>
        </param>
        <briefdescription>
<para>Calibrate the silence filter. </para>        </briefdescription>
        <detaileddescription>
<para>Calibration to determine an initial silence threshold. This function can be called any number of times. It should be called at least once immediately after cont_ad_init. The silence threshold is also updated internally once in a while, so this function only needs to be called in the middle if there is a definite change in the recording environment. The application is responsible for making sure that the raw audio source is turned on before the calibration. Return value: 0 if successful, &lt;0 otherwise. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="1022" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="1022" bodyend="1055"/>
        <references refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" compoundref="cont__ad_8h" startline="194">cont_ad_t::pow_hist</references>
        <references refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" compoundref="cont__ad_8h" startline="188">cont_ad_t::headfrm</references>
        <references refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" compoundref="cont__ad_8h" startline="189">cont_ad_t::n_frm</references>
        <references refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" compoundref="cont__ad_8h" startline="185">cont_ad_t::spf</references>
        <references refid="structcont__ad__t_1ac6e6809727ddc78a13674478d5b527db" compoundref="cont__ad_8h" startline="236">cont_ad_t::n_calib_frame</references>
        <references refid="structcont__ad__t_1aae5b9d977e62424b0cf0e245485b20a0" compoundref="cont__ad_8h" startline="154">cont_ad_t::ad</references>
        <references refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" compoundref="cont__ad_8h" startline="158">cont_ad_t::adbuf</references>
        <references refid="structcont__ad__t_1a2168183b25add085cf3aa29ddab1c8ce" compoundref="cont__ad_8h" startline="212">cont_ad_t::thresh_update</references>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a143612c1f673988487da99aec5a86575" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 cont_ad_calib_size</definition>
        <argsstring>(cont_ad_t *r)</argsstring>
        <name>cont_ad_calib_size</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
        </param>
        <briefdescription>
<para>Get the number of samples required to calibrate the silence filter. </para>        </briefdescription>
        <detaileddescription>
<para>Since, as mentioned above, the calibration data is assumed to be fully consumed, it may be desirable to &quot;hold onto&quot; this data in case it contains useful speech. This function returns the number of samples required to calibrate the silence filter, which is useful in allocating a buffer to store this data.</para><para><simplesect kind="return"><para>Number of samples required for successful calibration. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="1058" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="1058" bodyend="1061"/>
        <references refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" compoundref="cont__ad_8h" startline="185">cont_ad_t::spf</references>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a20156af01c8fc17e9bfaf8f8da88f94b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 cont_ad_calib_loop</definition>
        <argsstring>(cont_ad_t *r, int16 *buf, int32 max)</argsstring>
        <name>cont_ad_calib_loop</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
        </param>
        <param>
          <type>int16 *</type>
          <declname>buf</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>max</declname>
        </param>
        <briefdescription>
<para>Calibrate the silence filter without an audio device. </para>        </briefdescription>
        <detaileddescription>
<para>If the application has not passed an audio device into the silence filter at initialisation, this routine can be used to calibrate the filter. The buf (of length max samples) should contain audio data for calibration. This data is assumed to be completely consumed. More than one call may be necessary to fully calibrate. Return value: 0 if successful, &lt;0 on failure, &gt;0 if calibration not complete. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="1064" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="1064" bodyend="1095"/>
        <references refid="structcont__ad__t_1ac6e6809727ddc78a13674478d5b527db" compoundref="cont__ad_8h" startline="236">cont_ad_t::n_calib_frame</references>
        <references refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" compoundref="cont__ad_8h" startline="194">cont_ad_t::pow_hist</references>
        <references refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" compoundref="cont__ad_8h" startline="188">cont_ad_t::headfrm</references>
        <references refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" compoundref="cont__ad_8h" startline="189">cont_ad_t::n_frm</references>
        <references refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" compoundref="cont__ad_8h" startline="185">cont_ad_t::spf</references>
        <references refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" compoundref="cont__ad_8h" startline="158">cont_ad_t::adbuf</references>
        <references refid="structcont__ad__t_1a2168183b25add085cf3aa29ddab1c8ce" compoundref="cont__ad_8h" startline="212">cont_ad_t::thresh_update</references>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a0dba16480215e08c5d5c56bb873d7b14" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 cont_ad_set_thresh</definition>
        <argsstring>(cont_ad_t *r, int32 sil, int32 speech)</argsstring>
        <name>cont_ad_set_thresh</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>cont</declname>
          <defname>r</defname>
          <briefdescription><para>In: Object ptr from cont_ad_init </para></briefdescription>
        </param>
        <param>
          <type>int32</type>
          <declname>sil</declname>
          <briefdescription><para>In: silence threshold (default 2) </para></briefdescription>
        </param>
        <param>
          <type>int32</type>
          <declname>sp</declname>
          <defname>speech</defname>
          <briefdescription><para>In: speech threshold (default 2) </para></briefdescription>
        </param>
        <briefdescription>
<para>Set silence and speech threshold parameters. </para>        </briefdescription>
        <detaileddescription>
<para>The silence threshold is the max power level, RELATIVE to the peak background noise level, in any silence frame. Similarly, the speech threshold is the min power level, RELATIVE to the peak background noise level, in any speech frame. In general, silence threshold &lt;= speech threshold. Increasing the thresholds (say, from the default value of 2 to 3 or 4) reduces the sensitivity to background noise, but may also increase the chances of clipping actual speech. <simplesect kind="return"><para>: 0 if successful, &lt;0 otherwise. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="1100" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="1100" bodyend="1115"/>
        <references refid="structcont__ad__t_1a74a6f56fb4cbde7fc789c9b463cf2f8f" compoundref="cont__ad_8h" startline="198">cont_ad_t::delta_sil</references>
        <references refid="structcont__ad__t_1afca0f69a21d9f28c9610fcefc0e7cb10" compoundref="cont__ad_8h" startline="199">cont_ad_t::delta_speech</references>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1aa0d3ba735c5cea50070b92f808732afc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 cont_ad_set_params</definition>
        <argsstring>(cont_ad_t *r, int32 delta_sil, int32 delta_speech, int32 min_noise, int32 max_noise, int32 winsize, int32 speech_onset, int32 sil_onset, int32 leader, int32 trailer, float32 adapt_rate)</argsstring>
        <name>cont_ad_set_params</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>delta_sil</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>delta_speech</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>min_noise</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>max_noise</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>winsize</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>speech_onset</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>sil_onset</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>leader</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>trailer</declname>
        </param>
        <param>
          <type>float32</type>
          <declname>adapt_rate</declname>
        </param>
        <briefdescription>
<para>Set the changable parameters. </para>        </briefdescription>
        <detaileddescription>
<para>delta_sil, delta_speech, min_noise, and max_noise are in dB, winsize, speech_onset, sil_onset, leader and trailer are in frames of 16 ms length (256 samples @ 16kHz sampling). </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="1126" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="1126" bodyend="1188"/>
        <references refid="err_8h_1a87a0a12135a290cf16d06b63fcfa0ccf" compoundref="err_8h" startline="121">E_ERROR</references>
        <references refid="structcont__ad__t_1a74a6f56fb4cbde7fc789c9b463cf2f8f" compoundref="cont__ad_8h" startline="198">cont_ad_t::delta_sil</references>
        <references refid="structcont__ad__t_1afca0f69a21d9f28c9610fcefc0e7cb10" compoundref="cont__ad_8h" startline="199">cont_ad_t::delta_speech</references>
        <references refid="structcont__ad__t_1ac301114b24356aef2edccba155e3cf33" compoundref="cont__ad_8h" startline="200">cont_ad_t::min_noise</references>
        <references refid="structcont__ad__t_1af3b50663565964bb18ebb9f9e0002421" compoundref="cont__ad_8h" startline="201">cont_ad_t::max_noise</references>
        <references refid="structcont__ad__t_1a7c61513f48e8fbc9ab6b57db66dad7b9" compoundref="cont__ad_8h" startline="202">cont_ad_t::winsize</references>
        <references refid="structcont__ad__t_1a1b0bb7e53a2bf537ed362badddca341b" compoundref="cont__ad_8h" startline="203">cont_ad_t::speech_onset</references>
        <references refid="structcont__ad__t_1a9f5e138f4b79b59bf4daa5603d171165" compoundref="cont__ad_8h" startline="204">cont_ad_t::sil_onset</references>
        <references refid="structcont__ad__t_1a0d42e3ac6c1e5c59c86a40f4cf26a861" compoundref="cont__ad_8h" startline="205">cont_ad_t::leader</references>
        <references refid="structcont__ad__t_1aa15db1e9fbb0048225521555ab8d9388" compoundref="cont__ad_8h" startline="206">cont_ad_t::trailer</references>
        <references refid="structcont__ad__t_1ac22395096037175bf9a0a1f6877e5ec5" compoundref="cont__ad_8h" startline="213">cont_ad_t::adapt_rate</references>
        <references refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" compoundref="cont__ad_8h" startline="221">cont_ad_t::win_validfrm</references>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a634115e745aa62672e609f5820e8bb92" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 cont_ad_get_params</definition>
        <argsstring>(cont_ad_t *r, int32 *delta_sil, int32 *delta_speech, int32 *min_noise, int32 *max_noise, int32 *winsize, int32 *speech_onset, int32 *sil_onset, int32 *leader, int32 *trailer, float32 *adapt_rate)</argsstring>
        <name>cont_ad_get_params</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
        </param>
        <param>
          <type>int32 *</type>
          <declname>delta_sil</declname>
        </param>
        <param>
          <type>int32 *</type>
          <declname>delta_speech</declname>
        </param>
        <param>
          <type>int32 *</type>
          <declname>min_noise</declname>
        </param>
        <param>
          <type>int32 *</type>
          <declname>max_noise</declname>
        </param>
        <param>
          <type>int32 *</type>
          <declname>winsize</declname>
        </param>
        <param>
          <type>int32 *</type>
          <declname>speech_onset</declname>
        </param>
        <param>
          <type>int32 *</type>
          <declname>sil_onset</declname>
        </param>
        <param>
          <type>int32 *</type>
          <declname>leader</declname>
        </param>
        <param>
          <type>int32 *</type>
          <declname>trailer</declname>
        </param>
        <param>
          <type>float32 *</type>
          <declname>adapt_rate</declname>
        </param>
        <briefdescription>
<para>PWP 1/14/98 <ndash/> get the changable params. </para>        </briefdescription>
        <detaileddescription>
<para>delta_sil, delta_speech, min_noise, and max_noise are in dB, winsize, speech_onset, sil_onset, leader and trailer are in frames of 16 ms length (256 samples @ 16kHz sampling). </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="1199" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="1199" bodyend="1229"/>
        <references refid="structcont__ad__t_1a74a6f56fb4cbde7fc789c9b463cf2f8f" compoundref="cont__ad_8h" startline="198">cont_ad_t::delta_sil</references>
        <references refid="structcont__ad__t_1afca0f69a21d9f28c9610fcefc0e7cb10" compoundref="cont__ad_8h" startline="199">cont_ad_t::delta_speech</references>
        <references refid="structcont__ad__t_1ac301114b24356aef2edccba155e3cf33" compoundref="cont__ad_8h" startline="200">cont_ad_t::min_noise</references>
        <references refid="structcont__ad__t_1af3b50663565964bb18ebb9f9e0002421" compoundref="cont__ad_8h" startline="201">cont_ad_t::max_noise</references>
        <references refid="structcont__ad__t_1a7c61513f48e8fbc9ab6b57db66dad7b9" compoundref="cont__ad_8h" startline="202">cont_ad_t::winsize</references>
        <references refid="structcont__ad__t_1a1b0bb7e53a2bf537ed362badddca341b" compoundref="cont__ad_8h" startline="203">cont_ad_t::speech_onset</references>
        <references refid="structcont__ad__t_1a9f5e138f4b79b59bf4daa5603d171165" compoundref="cont__ad_8h" startline="204">cont_ad_t::sil_onset</references>
        <references refid="structcont__ad__t_1a0d42e3ac6c1e5c59c86a40f4cf26a861" compoundref="cont__ad_8h" startline="205">cont_ad_t::leader</references>
        <references refid="structcont__ad__t_1aa15db1e9fbb0048225521555ab8d9388" compoundref="cont__ad_8h" startline="206">cont_ad_t::trailer</references>
        <references refid="structcont__ad__t_1ac22395096037175bf9a0a1f6877e5ec5" compoundref="cont__ad_8h" startline="213">cont_ad_t::adapt_rate</references>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a28bfb72dbe4d7b77d9ddea142b156574" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 cont_ad_reset</definition>
        <argsstring>(cont_ad_t *r)</argsstring>
        <name>cont_ad_reset</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>cont</declname>
          <defname>r</defname>
        </param>
        <briefdescription>
<para>Reset, discarding any accumulated speech segments. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="return"><para>0 if successful, &lt;0 otherwise. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="1236" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="1236" bodyend="1260"/>
        <references refid="structcont__ad__t_1abffe61140bc2a02ae4222183b3ef6159" compoundref="cont__ad_8h" startline="224">cont_ad_t::spseg_head</references>
        <references refid="structcont__ad__t_1ac77e8f8bd27cea3b99238d9663455972" compoundref="cont__ad_8h" startline="225">cont_ad_t::spseg_tail</references>
        <references refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" compoundref="cont__ad_8h" startline="188">cont_ad_t::headfrm</references>
        <references refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" compoundref="cont__ad_8h" startline="189">cont_ad_t::n_frm</references>
        <references refid="structcont__ad__t_1a7ae5362560d9edfa6c16555285487a7a" compoundref="cont__ad_8h" startline="190">cont_ad_t::n_sample</references>
        <references refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" compoundref="cont__ad_8h" startline="220">cont_ad_t::win_startfrm</references>
        <references refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" compoundref="cont__ad_8h" startline="221">cont_ad_t::win_validfrm</references>
        <references refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" compoundref="cont__ad_8h" startline="222">cont_ad_t::n_other</references>
        <references refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" compoundref="cont__ad_8h" startline="217">cont_ad_t::tail_state</references>
        <referencedby refid="cont__ad_8h_1a381c3df971d43a20e8e8b8da43d2872d" compoundref="cont__ad__base_8c" startline="1264" endline="1277">cont_ad_close</referencedby>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1ad82cff9c5baa515fdb337235748fa0bc" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 cont_ad_close</definition>
        <argsstring>(cont_ad_t *cont)</argsstring>
        <name>cont_ad_close</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>cont</declname>
        </param>
        <briefdescription>
<para>Close the continuous listening object. </para>        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="1264" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="1264" bodyend="1277"/>
        <references refid="cont__ad_8h_1a12a017ea8a96dc54445e937bb9de24ae" compoundref="cont__ad__base_8c" startline="1236" endline="1260">cont_ad_reset</references>
        <references refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" compoundref="cont__ad_8h" startline="158">cont_ad_t::adbuf</references>
        <references refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" compoundref="cont__ad_8h" startline="194">cont_ad_t::pow_hist</references>
        <references refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" compoundref="cont__ad_8h" startline="195">cont_ad_t::frm_pow</references>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a30d9549fd1607191d1bd37925c5a1c83" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 cont_ad_detach</definition>
        <argsstring>(cont_ad_t *c)</argsstring>
        <name>cont_ad_detach</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>c</declname>
        </param>
        <briefdescription>
<para>Detach the given continuous listening module from the associated audio device. </para>        </briefdescription>
        <detaileddescription>
<para><simplesect kind="return"><para>0 if successful, -1 otherwise. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="1281" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="1281" bodyend="1289"/>
        <references refid="structcont__ad__t_1aae5b9d977e62424b0cf0e245485b20a0" compoundref="cont__ad_8h" startline="154">cont_ad_t::ad</references>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a66f2fa46fda4973f7ce558b8c3268d68" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 cont_ad_attach</definition>
        <argsstring>(cont_ad_t *c, ad_rec_t *a, int32(*func)(ad_rec_t *, int16 *, int32))</argsstring>
        <name>cont_ad_attach</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>c</declname>
        </param>
        <param>
          <type><ref refid="structad__rec__t" kindref="compound">ad_rec_t</ref> *</type>
          <declname>a</declname>
        </param>
        <param>
          <type>int32(*)(<ref refid="structad__rec__t" kindref="compound">ad_rec_t</ref> *, int16 *, int32)</type>
          <declname>func</declname>
        </param>
        <briefdescription>
<para>Attach the continuous listening module to the given audio device/function. </para>        </briefdescription>
        <detaileddescription>
<para>(Like cont_ad_init, but without the calibration.) <simplesect kind="return"><para>0 if successful, -1 otherwise. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="1293" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="1293" bodyend="1304"/>
        <references refid="structcont__ad__t_1aae5b9d977e62424b0cf0e245485b20a0" compoundref="cont__ad_8h" startline="154">cont_ad_t::ad</references>
        <references refid="structcont__ad__t_1af7b9044b76ed3b86ce74e4e7215ca4c3" compoundref="cont__ad_8h" startline="183">cont_ad_t::eof</references>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a7cda48d64f96544852fcad1f6cc01814" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 cont_set_thresh</definition>
        <argsstring>(cont_ad_t *r, int32 silence, int32 speech)</argsstring>
        <name>cont_set_thresh</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>r</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>silence</declname>
        </param>
        <param>
          <type>int32</type>
          <declname>speech</declname>
        </param>
        <briefdescription>
<para>Set the silence and speech thresholds. </para>        </briefdescription>
        <detaileddescription>
<para>For this to remain permanently in effect, the auto_thresh field of the continuous listening module should be set to FALSE or 0. Otherwise the thresholds may be modified by the noise- level adaptation. </para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="1308" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="1308" bodyend="1339"/>
        <references refid="structcont__ad__t_1a0b9333d9acc41b5bfb67f69fc22ca901" compoundref="cont__ad_8h" startline="208">cont_ad_t::thresh_speech</references>
        <references refid="structcont__ad__t_1adbbe28dca87d06a3ca8d2390d08ea83a" compoundref="cont__ad_8h" startline="210">cont_ad_t::thresh_sil</references>
        <references refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" compoundref="cont__ad_8h" startline="222">cont_ad_t::n_other</references>
        <references refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" compoundref="cont__ad_8h" startline="217">cont_ad_t::tail_state</references>
        <references refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" compoundref="cont__ad_8h" startline="221">cont_ad_t::win_validfrm</references>
        <references refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" compoundref="cont__ad_8h" startline="220">cont_ad_t::win_startfrm</references>
        <references refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" compoundref="cont__ad_8h" startline="195">cont_ad_t::frm_pow</references>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a2fcc85bebe9aa2bb2af7fc45032a62e5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 cont_ad_set_rawfp</definition>
        <argsstring>(cont_ad_t *r, FILE *fp)</argsstring>
        <name>cont_ad_set_rawfp</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>c</declname>
          <defname>r</defname>
        </param>
        <param>
          <type>FILE *</type>
          <declname>fp</declname>
        </param>
        <briefdescription>
<para>Set a file for dumping raw audio input. </para>        </briefdescription>
        <detaileddescription>
<para>The application can ask cont_ad to dump the raw audio input that cont_ad processes to a file. Use this function to give the FILE* to the cont_ad object. If invoked with fp == NULL, dumping is turned off. The application is responsible for opening and closing the file. If fp is non-NULL, cont_ad assumes the file pointer is valid and opened for writing.</para><para><simplesect kind="return"><para>0 if successful, -1 otherwise. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="1346" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="1346" bodyend="1353"/>
        <references refid="structcont__ad__t_1af8cd2a7e0ef0f4e2c825c7812a091f9c" compoundref="cont__ad_8h" startline="227">cont_ad_t::rawfp</references>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a108cac2deceb197502d2f5700ecbb09f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>int32</type>
        <definition>int32 cont_ad_set_logfp</definition>
        <argsstring>(cont_ad_t *r, FILE *fp)</argsstring>
        <name>cont_ad_set_logfp</name>
        <param>
          <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
          <declname>c</declname>
          <defname>r</defname>
        </param>
        <param>
          <type>FILE *</type>
          <declname>fp</declname>
        </param>
        <briefdescription>
<para>Set the file to which cont_ad logs its progress. </para>        </briefdescription>
        <detaileddescription>
<para>Mainly for debugging. If <computeroutput>fp</computeroutput> is NULL, logging is turned off.</para><para><simplesect kind="return"><para>0 if successful, -1 otherwise. </para></simplesect>
</para>        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="1360" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="1360" bodyend="1367"/>
        <references refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" compoundref="cont__ad_8h" startline="231">cont_ad_t::logfp</references>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a81102b9e6cb4f5b6c9a0c10dee6a4254" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
        <definition>cont_ad_t* cont_ad_init</definition>
        <argsstring>(ad_rec_t *a, int32(*func)(ad_rec_t *, int16 *, int32))</argsstring>
        <name>cont_ad_init</name>
        <param>
          <type><ref refid="structad__rec__t" kindref="compound">ad_rec_t</ref> *</type>
          <declname>a</declname>
        </param>
        <param>
          <type>int32(*)(<ref refid="structad__rec__t" kindref="compound">ad_rec_t</ref> *, int16 *, int32)</type>
          <declname>func</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="1374" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="1374" bodyend="1455"/>
      </memberdef>
      <memberdef kind="function" id="cont__ad__base_8c_1a83972cfa013182417dd59cd8f7cc2eb5" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref> *</type>
        <definition>cont_ad_t* cont_ad_init_rawmode</definition>
        <argsstring>(ad_rec_t *a, int32(*func)(ad_rec_t *, int16 *, int32))</argsstring>
        <name>cont_ad_init_rawmode</name>
        <param>
          <type><ref refid="structad__rec__t" kindref="compound">ad_rec_t</ref> *</type>
          <declname>a</declname>
        </param>
        <param>
          <type>int32(*)(<ref refid="structad__rec__t" kindref="compound">ad_rec_t</ref> *, int16 *, int32)</type>
          <declname>func</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" line="1459" column="1" bodyfile="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c" bodystart="1459" bodyend="1468"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">/*<sp/>-*-<sp/>c-basic-offset:<sp/>4;<sp/>indent-tabs-mode:<sp/>nil<sp/>-*-<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>====================================================================</highlight></codeline>
<codeline lineno="3"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>1999-2001<sp/>Carnegie<sp/>Mellon<sp/>University.<sp/><sp/>All<sp/>rights</highlight></codeline>
<codeline lineno="4"><highlight class="comment"><sp/>*<sp/>reserved.</highlight></codeline>
<codeline lineno="5"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="6"><highlight class="comment"><sp/>*<sp/>Redistribution<sp/>and<sp/>use<sp/>in<sp/>source<sp/>and<sp/>binary<sp/>forms,<sp/>with<sp/>or<sp/>without</highlight></codeline>
<codeline lineno="7"><highlight class="comment"><sp/>*<sp/>modification,<sp/>are<sp/>permitted<sp/>provided<sp/>that<sp/>the<sp/>following<sp/>conditions</highlight></codeline>
<codeline lineno="8"><highlight class="comment"><sp/>*<sp/>are<sp/>met:</highlight></codeline>
<codeline lineno="9"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="10"><highlight class="comment"><sp/>*<sp/>1.<sp/>Redistributions<sp/>of<sp/>source<sp/>code<sp/>must<sp/>retain<sp/>the<sp/>above<sp/>copyright</highlight></codeline>
<codeline lineno="11"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer.<sp/></highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*<sp/>2.<sp/>Redistributions<sp/>in<sp/>binary<sp/>form<sp/>must<sp/>reproduce<sp/>the<sp/>above<sp/>copyright</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer<sp/>in</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>the<sp/>documentation<sp/>and/or<sp/>other<sp/>materials<sp/>provided<sp/>with<sp/>the</highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>distribution.</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/>This<sp/>work<sp/>was<sp/>supported<sp/>in<sp/>part<sp/>by<sp/>funding<sp/>from<sp/>the<sp/>Defense<sp/>Advanced<sp/></highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*<sp/>Research<sp/>Projects<sp/>Agency<sp/>and<sp/>the<sp/>National<sp/>Science<sp/>Foundation<sp/>of<sp/>the<sp/></highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*<sp/>United<sp/>States<sp/>of<sp/>America,<sp/>and<sp/>the<sp/>CMU<sp/>Sphinx<sp/>Speech<sp/>Consortium.</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*<sp/>THIS<sp/>SOFTWARE<sp/>IS<sp/>PROVIDED<sp/>BY<sp/>CARNEGIE<sp/>MELLON<sp/>UNIVERSITY<sp/>``AS<sp/>IS&apos;&apos;<sp/>AND<sp/></highlight></codeline>
<codeline lineno="23"><highlight class="comment"><sp/>*<sp/>ANY<sp/>EXPRESSED<sp/>OR<sp/>IMPLIED<sp/>WARRANTIES,<sp/>INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,<sp/></highlight></codeline>
<codeline lineno="24"><highlight class="comment"><sp/>*<sp/>THE<sp/>IMPLIED<sp/>WARRANTIES<sp/>OF<sp/>MERCHANTABILITY<sp/>AND<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR</highlight></codeline>
<codeline lineno="25"><highlight class="comment"><sp/>*<sp/>PURPOSE<sp/>ARE<sp/>DISCLAIMED.<sp/><sp/>IN<sp/>NO<sp/>EVENT<sp/>SHALL<sp/>CARNEGIE<sp/>MELLON<sp/>UNIVERSITY</highlight></codeline>
<codeline lineno="26"><highlight class="comment"><sp/>*<sp/>NOR<sp/>ITS<sp/>EMPLOYEES<sp/>BE<sp/>LIABLE<sp/>FOR<sp/>ANY<sp/>DIRECT,<sp/>INDIRECT,<sp/>INCIDENTAL,</highlight></codeline>
<codeline lineno="27"><highlight class="comment"><sp/>*<sp/>SPECIAL,<sp/>EXEMPLARY,<sp/>OR<sp/>CONSEQUENTIAL<sp/>DAMAGES<sp/>(INCLUDING,<sp/>BUT<sp/>NOT<sp/></highlight></codeline>
<codeline lineno="28"><highlight class="comment"><sp/>*<sp/>LIMITED<sp/>TO,<sp/>PROCUREMENT<sp/>OF<sp/>SUBSTITUTE<sp/>GOODS<sp/>OR<sp/>SERVICES;<sp/>LOSS<sp/>OF<sp/>USE,<sp/></highlight></codeline>
<codeline lineno="29"><highlight class="comment"><sp/>*<sp/>DATA,<sp/>OR<sp/>PROFITS;<sp/>OR<sp/>BUSINESS<sp/>INTERRUPTION)<sp/>HOWEVER<sp/>CAUSED<sp/>AND<sp/>ON<sp/>ANY<sp/></highlight></codeline>
<codeline lineno="30"><highlight class="comment"><sp/>*<sp/>THEORY<sp/>OF<sp/>LIABILITY,<sp/>WHETHER<sp/>IN<sp/>CONTRACT,<sp/>STRICT<sp/>LIABILITY,<sp/>OR<sp/>TORT<sp/></highlight></codeline>
<codeline lineno="31"><highlight class="comment"><sp/>*<sp/>(INCLUDING<sp/>NEGLIGENCE<sp/>OR<sp/>OTHERWISE)<sp/>ARISING<sp/>IN<sp/>ANY<sp/>WAY<sp/>OUT<sp/>OF<sp/>THE<sp/>USE<sp/></highlight></codeline>
<codeline lineno="32"><highlight class="comment"><sp/>*<sp/>OF<sp/>THIS<sp/>SOFTWARE,<sp/>EVEN<sp/>IF<sp/>ADVISED<sp/>OF<sp/>THE<sp/>POSSIBILITY<sp/>OF<sp/>SUCH<sp/>DAMAGE.</highlight></codeline>
<codeline lineno="33"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="34"><highlight class="comment"><sp/>*<sp/>====================================================================</highlight></codeline>
<codeline lineno="35"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="36"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="37"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="38"><highlight class="comment"><sp/>*<sp/>cont_ad.c<sp/>--<sp/>Continuous<sp/>A/D<sp/>listening<sp/>and<sp/>silence<sp/>filtering<sp/>module.</highlight></codeline>
<codeline lineno="39"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="40"><highlight class="comment"><sp/>*<sp/>HISTORY</highlight></codeline>
<codeline lineno="41"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="42"><highlight class="comment"><sp/>*<sp/>$Log:<sp/>cont_ad_base.c,v<sp/>$</highlight></codeline>
<codeline lineno="43"><highlight class="comment"><sp/>*<sp/>Revision<sp/>1.14<sp/><sp/>2005/07/02<sp/>03:51:32<sp/><sp/>rkm</highlight></codeline>
<codeline lineno="44"><highlight class="comment"><sp/>*<sp/>Slowed<sp/>down<sp/>power<sp/>histogram<sp/>decay<sp/>rate</highlight></codeline>
<codeline lineno="45"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="46"><highlight class="comment"><sp/>*<sp/>Revision<sp/>1.13<sp/><sp/>2005/06/30<sp/>00:27:17<sp/><sp/>rkm</highlight></codeline>
<codeline lineno="47"><highlight class="comment"><sp/>*<sp/>Fixed<sp/>silence<sp/>handling<sp/>in<sp/>rawmode;<sp/>added<sp/>extra<sp/>state<sp/>variables</highlight></codeline>
<codeline lineno="48"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="49"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="50"><highlight class="comment"><sp/>*<sp/>28-Jun-2005<sp/><sp/>M<sp/>K<sp/>Ravishankar<sp/>(rkm@cs.cmu.edu)<sp/>at<sp/>Carnegie<sp/>Mellon<sp/>University.</highlight></codeline>
<codeline lineno="51"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Changed<sp/>rawmode<sp/>handling<sp/>to<sp/>simply<sp/>copy<sp/>data<sp/>even<sp/>for<sp/>silence</highlight></codeline>
<codeline lineno="52"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>segments.</highlight></codeline>
<codeline lineno="53"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>-<sp/>Moved<sp/>definitions<sp/>of<sp/>CONT_AD_STATE_{SIL,SPEECH}<sp/>from<sp/>.c<sp/>to<sp/>.h.</highlight></codeline>
<codeline lineno="54"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="55"><highlight class="comment"><sp/>*<sp/>Revision<sp/>1.12<sp/><sp/>2005/06/29<sp/>23:48:04<sp/><sp/>egouvea</highlight></codeline>
<codeline lineno="56"><highlight class="comment"><sp/>*<sp/>Revert<sp/>changes:<sp/>variables<sp/>defined<sp/>in<sp/>cont_ad_base.c<sp/>should<sp/>not<sp/>be<sp/>accessible<sp/>by<sp/>the<sp/>application</highlight></codeline>
<codeline lineno="57"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="58"><highlight class="comment"><sp/>*<sp/>Revision<sp/>1.10<sp/><sp/>2005/02/13<sp/>01:29:48<sp/><sp/>rkm</highlight></codeline>
<codeline lineno="59"><highlight class="comment"><sp/>*<sp/>Fixed<sp/>cont_ad_read<sp/>to<sp/>never<sp/>cross<sp/>sil/speech<sp/>boundary,<sp/>and<sp/>rawmode</highlight></codeline>
<codeline lineno="60"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="61"><highlight class="comment"><sp/>*<sp/>Revision<sp/>1.9<sp/><sp/>2005/02/01<sp/>22:21:19<sp/><sp/>rkm</highlight></codeline>
<codeline lineno="62"><highlight class="comment"><sp/>*<sp/>Added<sp/>raw<sp/>data<sp/>logging,<sp/>and<sp/>raw<sp/>data<sp/>pass-through<sp/>mode<sp/>to<sp/>cont_ad</highlight></codeline>
<codeline lineno="63"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="64"><highlight class="comment"><sp/>*<sp/>Revision<sp/>1.8<sp/><sp/>2004/07/23<sp/>23:36:34<sp/><sp/>egouvea</highlight></codeline>
<codeline lineno="65"><highlight class="comment"><sp/>*<sp/>Ravi&apos;s<sp/>merge,<sp/>with<sp/>the<sp/>latest<sp/>fixes<sp/>in<sp/>the<sp/>FSG<sp/>code,<sp/>and<sp/>making<sp/>the<sp/>log<sp/>files<sp/>generated<sp/>by<sp/>FSG,<sp/>LM,<sp/>and<sp/>allphone<sp/>have<sp/>the<sp/>same<sp/>&apos;look<sp/>and<sp/>feel&apos;,<sp/>with<sp/>the<sp/>backtrace<sp/>information<sp/>presented<sp/>consistently</highlight></codeline>
<codeline lineno="66"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="67"><highlight class="comment"><sp/>*<sp/>23-Jul-2004<sp/><sp/>M<sp/>K<sp/>Ravishankar<sp/>(rkm@cs.cmu.edu)<sp/>at<sp/>Carnegie<sp/>Mellon<sp/>University</highlight></codeline>
<codeline lineno="68"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Changed<sp/>default<sp/>adapt_rate<sp/>from<sp/>0.5<sp/>to<sp/>0.2.</highlight></codeline>
<codeline lineno="69"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="70"><highlight class="comment"><sp/>*<sp/>Revision<sp/>1.7<sp/><sp/>2004/07/16<sp/>00:57:12<sp/><sp/>egouvea</highlight></codeline>
<codeline lineno="71"><highlight class="comment"><sp/>*<sp/>Added<sp/>Ravi&apos;s<sp/>implementation<sp/>of<sp/>FSG<sp/>support.</highlight></codeline>
<codeline lineno="72"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="73"><highlight class="comment"><sp/>*<sp/>Revision<sp/>1.2<sp/><sp/>2004/06/23<sp/>20:31:18<sp/><sp/>rkm</highlight></codeline>
<codeline lineno="74"><highlight class="comment"><sp/>*<sp/>Added<sp/>adapt_rate<sp/>parameter;<sp/>restructured<sp/>frame<sp/>processing<sp/>to<sp/>include<sp/>threshold<sp/>update</highlight></codeline>
<codeline lineno="75"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="76"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="77"><highlight class="comment"><sp/>*<sp/>23-Oct-98<sp/><sp/><sp/><sp/>M<sp/>K<sp/>Ravishankar<sp/>(rkm@cs.cmu.edu)<sp/>at<sp/>Carnegie<sp/>Mellon<sp/>University</highlight></codeline>
<codeline lineno="78"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Small<sp/>change<sp/>in<sp/>the<sp/>way<sp/>the<sp/>noiselevel<sp/>is<sp/>updated<sp/>in<sp/>find_thresh().</highlight></codeline>
<codeline lineno="79"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="80"><highlight class="comment"><sp/>*<sp/>26-Aug-98<sp/><sp/><sp/><sp/>M<sp/>K<sp/>Ravishankar<sp/>(rkm@cs.cmu.edu)<sp/>at<sp/>Carnegie<sp/>Mellon<sp/>University</highlight></codeline>
<codeline lineno="81"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Separated<sp/>computation<sp/>of<sp/>&quot;frame<sp/>power&quot;<sp/>into<sp/>a<sp/>separate<sp/>low-level</highlight></codeline>
<codeline lineno="82"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>function.</highlight></codeline>
<codeline lineno="83"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="84"><highlight class="comment"><sp/>*<sp/>13-Jul-98<sp/><sp/><sp/><sp/>M<sp/>K<sp/>Ravishankar<sp/>(rkm@cs.cmu.edu)<sp/>at<sp/>Carnegie<sp/>Mellon<sp/>University</highlight></codeline>
<codeline lineno="85"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Modified<sp/>to<sp/>allow<sp/>frame<sp/>size<sp/>to<sp/>depend<sp/>on<sp/>audio<sp/>sampling<sp/>rate.</highlight></codeline>
<codeline lineno="86"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="87"><highlight class="comment"><sp/>*<sp/>01-Jul-98<sp/><sp/><sp/><sp/>M<sp/>K<sp/>Ravishankar<sp/>(rkm@cs.cmu.edu)<sp/>at<sp/>Carnegie<sp/>Mellon<sp/>University</highlight></codeline>
<codeline lineno="88"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Changed<sp/>CONT_AD_DELTA_SPEECH<sp/>back<sp/>to<sp/>20.</highlight></codeline>
<codeline lineno="89"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="90"><highlight class="comment"><sp/>*<sp/>30-Jun-98<sp/><sp/><sp/><sp/>M<sp/>K<sp/>Ravishankar<sp/>(rkm@cs.cmu.edu)<sp/>at<sp/>Carnegie<sp/>Mellon<sp/>University</highlight></codeline>
<codeline lineno="91"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Changed<sp/>CONT_AD_DELTA_SPEECH<sp/>from<sp/>10<sp/>to<sp/>15.</highlight></codeline>
<codeline lineno="92"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Added<sp/>FILE*<sp/>argument<sp/>to<sp/>cont_ad_powhist_dump().</highlight></codeline>
<codeline lineno="93"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="94"><highlight class="comment"><sp/>*<sp/>19-Jun-98<sp/><sp/><sp/><sp/>M<sp/>K<sp/>Ravishankar<sp/>(rkm@cs.cmu.edu)<sp/>at<sp/>Carnegie<sp/>Mellon<sp/>University</highlight></codeline>
<codeline lineno="95"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Changed<sp/>CONT_AD_DELTA_SPEECH<sp/>from<sp/>20<sp/>to<sp/>10,<sp/>to<sp/>increase<sp/>sensitivity</highlight></codeline>
<codeline lineno="96"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to<sp/>very<sp/>short<sp/>utterances.</highlight></codeline>
<codeline lineno="97"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="98"><highlight class="comment"><sp/>*<sp/>16-Jan-98<sp/><sp/><sp/><sp/>Paul<sp/>Placeway<sp/>(pwp@cs.cmu.edu)<sp/>at<sp/>Carnegie<sp/>Mellon<sp/>University</highlight></codeline>
<codeline lineno="99"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Changed<sp/>to<sp/>use<sp/>dB<sp/>instead<sp/>of<sp/>the<sp/>weird<sp/>power<sp/>measure.</highlight></codeline>
<codeline lineno="100"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Changed<sp/>analysis<sp/>window<sp/>size,<sp/>tuned<sp/>default<sp/>settings<sp/>of<sp/>most</highlight></codeline>
<codeline lineno="101"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>parameters<sp/>to<sp/>make<sp/>the<sp/>system<sp/>less<sp/>sensitive<sp/>to<sp/>noise,<sp/>changed</highlight></codeline>
<codeline lineno="102"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>the<sp/>histogram<sp/>update<sp/>frequency<sp/>and<sp/>decay<sp/>to<sp/>make<sp/>the<sp/>system</highlight></codeline>
<codeline lineno="103"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>adapt<sp/>more<sp/>rapidly<sp/>to<sp/>changes<sp/>in<sp/>the<sp/>environment.</highlight></codeline>
<codeline lineno="104"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Added<sp/>cont_ad_set_params()<sp/>and<sp/>cont_ad_get_params().</highlight></codeline>
<codeline lineno="105"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="106"><highlight class="comment"><sp/>*<sp/>28-Jul-96<sp/><sp/><sp/><sp/>M<sp/>K<sp/>Ravishankar<sp/>(rkm@cs.cmu.edu)<sp/>at<sp/>Carnegie<sp/>Mellon<sp/>University</highlight></codeline>
<codeline lineno="107"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Added<sp/>FRMPOW2SIGLVL,<sp/>max_siglvl(),<sp/>and<sp/>cont_ad_t.siglvl.</highlight></codeline>
<codeline lineno="108"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Changed<sp/>min<sp/>signal<sp/>energy/frame<sp/>to<sp/>CONT_AD_SPF.</highlight></codeline>
<codeline lineno="109"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="110"><highlight class="comment"><sp/>*<sp/>27-Jun-96<sp/><sp/><sp/><sp/>M<sp/>K<sp/>Ravishankar<sp/>(rkm@cs.cmu.edu)<sp/>at<sp/>Carnegie<sp/>Mellon<sp/>University</highlight></codeline>
<codeline lineno="111"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Added<sp/>the<sp/>option<sp/>for<sp/>cont_ad_read<sp/>to<sp/>return<sp/>-1<sp/>on<sp/>EOF.</highlight></codeline>
<codeline lineno="112"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="113"><highlight class="comment"><sp/>*<sp/>21-Jun-96<sp/><sp/><sp/><sp/>M<sp/>K<sp/>Ravishankar<sp/>(rkm@cs.cmu.edu)<sp/>at<sp/>Carnegie<sp/>Mellon<sp/>University</highlight></codeline>
<codeline lineno="114"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Added<sp/>cont_ad_set_thresh().</highlight></codeline>
<codeline lineno="115"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Bugfix:<sp/>n_other<sp/>is<sp/>recomputed<sp/>after<sp/>updating<sp/>thresholds.</highlight></codeline>
<codeline lineno="116"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="117"><highlight class="comment"><sp/>*<sp/>20-Jun-96<sp/><sp/><sp/><sp/>M<sp/>K<sp/>Ravishankar<sp/>(rkm@cs.cmu.edu)<sp/>at<sp/>Carnegie<sp/>Mellon<sp/>University</highlight></codeline>
<codeline lineno="118"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Separated<sp/>thresholds<sp/>for<sp/>speech<sp/>and<sp/>silence.</highlight></codeline>
<codeline lineno="119"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Fixed<sp/>bug<sp/>in<sp/>moving<sp/>analysis<sp/>window<sp/>upon<sp/>transition<sp/>to<sp/>speech<sp/>state.</highlight></codeline>
<codeline lineno="120"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="121"><highlight class="comment"><sp/>*<sp/>17-Jun-96<sp/><sp/><sp/><sp/>M<sp/>K<sp/>Ravishankar<sp/>(rkm@cs.cmu.edu)<sp/>at<sp/>Carnegie<sp/>Mellon<sp/>University</highlight></codeline>
<codeline lineno="122"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Created,<sp/>based<sp/>loosely<sp/>on<sp/>Steve<sp/>Reed&apos;s<sp/>original<sp/>implementation.</highlight></codeline>
<codeline lineno="123"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="125"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="126"><highlight class="comment"><sp/>*<sp/>This<sp/>module<sp/>is<sp/>intended<sp/>to<sp/>be<sp/>interposed<sp/>as<sp/>a<sp/>filter<sp/>between<sp/>any<sp/>raw<sp/>A/D<sp/>source<sp/>and<sp/>the</highlight></codeline>
<codeline lineno="127"><highlight class="comment"><sp/>*<sp/>application<sp/>to<sp/>remove<sp/>silence<sp/>regions.<sp/><sp/>It<sp/>is<sp/>initialized<sp/>with<sp/>a<sp/>raw<sp/>A/D<sp/>source<sp/>function</highlight></codeline>
<codeline lineno="128"><highlight class="comment"><sp/>*<sp/>(during<sp/>the<sp/>cont_ad_init<sp/>call).<sp/><sp/>Filtered<sp/>A/D<sp/>data<sp/>can<sp/>be<sp/>read<sp/>by<sp/>the<sp/>application<sp/>using</highlight></codeline>
<codeline lineno="129"><highlight class="comment"><sp/>*<sp/>the<sp/>cont_ad_read<sp/>function.<sp/><sp/>This<sp/>module<sp/>assumes<sp/>that<sp/>the<sp/>A/D<sp/>source<sp/>function<sp/>supplies<sp/>an</highlight></codeline>
<codeline lineno="130"><highlight class="comment"><sp/>*<sp/>endless<sp/>stream<sp/>of<sp/>data.<sp/><sp/>The<sp/>application<sp/>is<sp/>responsible<sp/>for<sp/>setting<sp/>up<sp/>the<sp/>A/D<sp/>source,</highlight></codeline>
<codeline lineno="131"><highlight class="comment"><sp/>*<sp/>turning<sp/>recording<sp/>on<sp/>and<sp/>off<sp/>as<sp/>it<sp/>desires.<sp/><sp/>It<sp/>is<sp/>also<sp/>responsible<sp/>for<sp/>invoking<sp/>the</highlight></codeline>
<codeline lineno="132"><highlight class="comment"><sp/>*<sp/>cont_ad_read<sp/>function<sp/>frequently<sp/>enough<sp/>to<sp/>avoid<sp/>buffer<sp/>overruns<sp/>and<sp/>dropping<sp/>A/D<sp/>data.</highlight></codeline>
<codeline lineno="133"><highlight class="comment"><sp/>*<sp/>This<sp/>continuous<sp/>listening<sp/>module<sp/>has<sp/>an<sp/>internal<sp/>buffer<sp/>of<sp/>about<sp/>4<sp/>sec.</highlight></codeline>
<codeline lineno="134"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="135"><highlight class="comment"><sp/>*<sp/>This<sp/>module<sp/>must<sp/>be<sp/>initialized<sp/>and<sp/>calibrated<sp/>at<sp/>first<sp/>(cont_ad_init<sp/>and<sp/>cont_ad_calib</highlight></codeline>
<codeline lineno="136"><highlight class="comment"><sp/>*<sp/>functions).<sp/><sp/>Raw<sp/>samples<sp/>are<sp/>grouped<sp/>into<sp/>frames,<sp/>the<sp/>signal<sp/>power<sp/>in<sp/>each<sp/>frame<sp/>is</highlight></codeline>
<codeline lineno="137"><highlight class="comment"><sp/>*<sp/>computed<sp/>and<sp/>accumulated<sp/>in<sp/>a<sp/>histogram.<sp/><sp/>The<sp/>module<sp/>is<sp/>always<sp/>in<sp/>one<sp/>of<sp/>two<sp/>states:</highlight></codeline>
<codeline lineno="138"><highlight class="comment"><sp/>*<sp/>SILENCE<sp/>or<sp/>SPEECH.<sp/><sp/>Transitions<sp/>between<sp/>the<sp/>two<sp/>states<sp/>are<sp/>detected<sp/>by<sp/>looking<sp/>for<sp/>a</highlight></codeline>
<codeline lineno="139"><highlight class="comment"><sp/>*<sp/>contiguous<sp/>window<sp/>of<sp/>several<sp/>frames<sp/>that<sp/>is<sp/>predominantly<sp/>of<sp/>the<sp/>other<sp/>type.<sp/><sp/>The<sp/>type</highlight></codeline>
<codeline lineno="140"><highlight class="comment"><sp/>*<sp/>is<sp/>determined<sp/>by<sp/>comparing<sp/>frame<sp/>power<sp/>to<sp/>either<sp/>of<sp/>two<sp/>thresholds,<sp/>thresh_sil<sp/>and</highlight></codeline>
<codeline lineno="141"><highlight class="comment"><sp/>*<sp/>thresh_speech,<sp/>as<sp/>appropriate<sp/>for<sp/>the<sp/>current<sp/>state.<sp/><sp/>These<sp/>thresholds<sp/>are<sp/>set<sp/>from<sp/>the</highlight></codeline>
<codeline lineno="142"><highlight class="comment"><sp/>*<sp/>first<sp/>peak<sp/>in<sp/>the<sp/>low-end<sp/>of<sp/>the<sp/>power<sp/>histogram,<sp/>and<sp/>are<sp/>updated<sp/>every<sp/>few<sp/>seconds.</highlight></codeline>
<codeline lineno="143"><highlight class="comment"><sp/>*<sp/>Separate<sp/>thresholds<sp/>are<sp/>used<sp/>to<sp/>provide<sp/>some<sp/>hysteresis.</highlight></codeline>
<codeline lineno="144"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="145"><highlight class="comment"><sp/>*<sp/>The<sp/>module<sp/>maintains<sp/>a<sp/>linked<sp/>list<sp/>of<sp/>speech<sp/>(non-silence)<sp/>segments<sp/>not<sp/>yet<sp/>read<sp/>by<sp/>the</highlight></codeline>
<codeline lineno="146"><highlight class="comment"><sp/>*<sp/>application.<sp/><sp/>The<sp/>cont_ad_read<sp/>function<sp/>returns<sp/>speech<sp/>data,<sp/>if<sp/>any<sp/>available,<sp/>by</highlight></codeline>
<codeline lineno="147"><highlight class="comment"><sp/>*<sp/>following<sp/>this<sp/>list.<sp/><sp/>It<sp/>also<sp/>updates<sp/>an<sp/>&quot;absolute&quot;<sp/>timestamp<sp/>at<sp/>the<sp/>end<sp/>of<sp/>the</highlight></codeline>
<codeline lineno="148"><highlight class="comment"><sp/>*<sp/>cont_ad_read<sp/>operation.<sp/><sp/>The<sp/>timestamp<sp/>indicates<sp/>the<sp/>total<sp/>#samples<sp/>of<sp/>A/D<sp/>data<sp/>read</highlight></codeline>
<codeline lineno="149"><highlight class="comment"><sp/>*<sp/>until<sp/>this<sp/>point,<sp/>including<sp/>data<sp/>discarded<sp/>as<sp/>silence<sp/>frames.<sp/><sp/>The<sp/>application<sp/>is</highlight></codeline>
<codeline lineno="150"><highlight class="comment"><sp/>*<sp/>responsible<sp/>for<sp/>using<sp/>this<sp/>timestamp<sp/>to<sp/>make<sp/>any<sp/>policy<sp/>decisions<sp/>regarding<sp/>utterance</highlight></codeline>
<codeline lineno="151"><highlight class="comment"><sp/>*<sp/>boundaries<sp/>or<sp/>whatever.</highlight></codeline>
<codeline lineno="152"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="153"><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdio.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="155"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdlib.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="156"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;string.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="157"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;assert.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;math.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="159"><highlight class="normal"></highlight></codeline>
<codeline lineno="160"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>HAVE_CONFIG_H</highlight></codeline>
<codeline lineno="161"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#include<sp/>&lt;config.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="162"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="163"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="164"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>_MSC_VER</highlight></codeline>
<codeline lineno="165"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#pragma<sp/>warning<sp/>(disable:<sp/>4305)</highlight></codeline>
<codeline lineno="166"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="167"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="prim__type_8h" kindref="compound">sphinxbase/prim_type.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="169"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="ad_8h" kindref="compound">sphinxbase/ad.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="cont__ad_8h" kindref="compound">sphinxbase/cont_ad.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="err_8h" kindref="compound">sphinxbase/err.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"></highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>_ABS</highlight></codeline>
<codeline lineno="175"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/>_ABS(x)<sp/>((x)<sp/>&gt;=<sp/>0<sp/>?<sp/>(x)<sp/>:<sp/>-(x))</highlight></codeline>
<codeline lineno="176"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="177"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="178"><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>Various<sp/>parameters,<sp/>including<sp/>defaults<sp/>for<sp/>many<sp/>cont_ad_t<sp/>member<sp/>variables<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="180"><highlight class="normal"></highlight></codeline>
<codeline lineno="181"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CONT_AD_ADFRMSIZE<sp/><sp/><sp/><sp/><sp/><sp/><sp/>256<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>#Frames<sp/>of<sp/>internal<sp/>A/D<sp/>buffer<sp/>maintained<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
<codeline lineno="182"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="183"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CONT_AD_POWHISTSIZE<sp/><sp/><sp/><sp/><sp/>98<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>#Powhist<sp/>bins:<sp/>~<sp/>FRMPOW(65536^2*CONT_AD_SPF)<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
<codeline lineno="184"><highlight class="preprocessor"></highlight><highlight class="comment">/*<sp/>Maximum<sp/>level<sp/>is<sp/>96.3<sp/>dB<sp/>full-scale;<sp/>97<sp/>for<sp/>safety,<sp/>plus<sp/>1<sp/>for<sp/>zero-based<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="185"><highlight class="normal"></highlight></codeline>
<codeline lineno="186"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CONT_AD_CALIB_FRAMES<sp/><sp/><sp/><sp/>(CONT_AD_POWHISTSIZE<sp/>*<sp/>2)</highlight></codeline>
<codeline lineno="187"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CONT_AD_THRESH_UPDATE<sp/><sp/><sp/>100<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>thresholds<sp/>approx<sp/>every<sp/>so<sp/>many<sp/>frames<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
<codeline lineno="189"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>PWP:<sp/>update<sp/>was<sp/>200<sp/>frames,<sp/>or<sp/>3.2<sp/>seconds.<sp/><sp/>Now<sp/>about<sp/>every<sp/>1.6<sp/>sec.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CONT_AD_ADAPT_RATE<sp/><sp/><sp/><sp/><sp/><sp/>0.2<sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Interpolation<sp/>of<sp/>new<sp/>and<sp/>old<sp/>noiselevel<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
<codeline lineno="192"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="193"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CONT_AD_SPS<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>16000</highlight></codeline>
<codeline lineno="194"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CONT_AD_DEFAULT_NOISE<sp/><sp/><sp/>30<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Default<sp/>background<sp/>noise<sp/>power<sp/>level<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
<codeline lineno="196"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/>CONT_AD_DELTA_SIL<sp/><sp/><sp/><sp/><sp/><sp/><sp/>10<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initial<sp/>default<sp/>for<sp/>cont_ad_t.delta_sil<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
<codeline lineno="197"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/>CONT_AD_DELTA_SPEECH<sp/><sp/><sp/><sp/>17<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Initial<sp/>default<sp/>for<sp/>cont_ad_t.delta_speech<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
<codeline lineno="198"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/>CONT_AD_MIN_NOISE<sp/><sp/><sp/><sp/><sp/><sp/><sp/>2<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Expected<sp/>minimum<sp/>background<sp/>noise<sp/>level<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
<codeline lineno="199"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/>CONT_AD_MAX_NOISE<sp/><sp/><sp/><sp/><sp/><sp/><sp/>70<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Maximum<sp/>background<sp/>noise<sp/>level<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
<codeline lineno="200"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CONT_AD_HIST_INERTIA<sp/><sp/><sp/><sp/>3<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Used<sp/>in<sp/>decaying<sp/>the<sp/>power<sp/>histogram<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
<codeline lineno="202"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="203"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CONT_AD_WINSIZE<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>21<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Analysis<sp/>window<sp/>for<sp/>state<sp/>transitions<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
<codeline lineno="204"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>rkm<sp/>had<sp/>16<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"></highlight></codeline>
<codeline lineno="206"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CONT_AD_SPEECH_ONSET<sp/><sp/><sp/><sp/>9<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Min<sp/>#speech<sp/>frames<sp/>in<sp/>analysis<sp/>window<sp/>for</highlight></codeline>
<codeline lineno="207"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SILENCE<sp/>-&gt;<sp/>SPEECH<sp/>state<sp/>transition<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
<codeline lineno="208"><highlight class="preprocessor"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="209"><highlight class="comment"><sp/>*<sp/>SReed<sp/>had<sp/>100<sp/>ms<sp/>==<sp/>6.25<sp/>fr<sp/>contiguous;<sp/>rkm<sp/>had<sp/>9<sp/>(out<sp/>of<sp/>16+10)<sp/>with<sp/>a</highlight></codeline>
<codeline lineno="210"><highlight class="comment"><sp/>*<sp/>lower<sp/>threshold.</highlight></codeline>
<codeline lineno="211"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="212"><highlight class="normal"></highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CONT_AD_SIL_ONSET<sp/><sp/><sp/><sp/><sp/><sp/><sp/>18<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Min<sp/>#silence<sp/>frames<sp/>in<sp/>analysis<sp/>window<sp/>for</highlight></codeline>
<codeline lineno="214"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SPEECH<sp/>-&gt;<sp/>SILENCE<sp/>state<sp/>transition</highlight></codeline>
<codeline lineno="215"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>MUST<sp/>BE<sp/>&lt;=<sp/>CONT_AD_WINSIZE<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
<codeline lineno="216"><highlight class="preprocessor"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="217"><highlight class="comment"><sp/>*<sp/>SReed<sp/>had<sp/>400<sp/>ms<sp/>==<sp/>25<sp/>fr<sp/>contiguous;<sp/>rkm<sp/>had<sp/>14<sp/>out<sp/>of<sp/>16</highlight></codeline>
<codeline lineno="218"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="219"><highlight class="normal"></highlight></codeline>
<codeline lineno="220"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CONT_AD_LEADER<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>5<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>On<sp/>transition<sp/>to<sp/>SPEECH<sp/>state,<sp/>so<sp/>many<sp/>frames</highlight></codeline>
<codeline lineno="221"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>BEFORE<sp/>window<sp/>included<sp/>in<sp/>speech<sp/>data<sp/>(&gt;0)<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
<codeline lineno="222"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>SReed<sp/>had<sp/>200<sp/>ms<sp/>==<sp/>12.5<sp/>fr;<sp/>rkm<sp/>had<sp/>5<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="223"><highlight class="normal"></highlight></codeline>
<codeline lineno="224"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>CONT_AD_TRAILER<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>10<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>On<sp/>transition<sp/>to<sp/>SILENCE<sp/>state,<sp/>so<sp/>many<sp/>frames</highlight></codeline>
<codeline lineno="225"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>of<sp/>silence<sp/>included<sp/>in<sp/>speech<sp/>data<sp/>(&gt;0).</highlight></codeline>
<codeline lineno="226"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOTE:<sp/>Ensure<sp/>(0<sp/>&lt;<sp/>TRAILER+LEADER<sp/>&lt;=<sp/>WINSIZE)<sp/>*/</highlight><highlight class="preprocessor"></highlight></codeline>
<codeline lineno="227"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>SReed<sp/>had<sp/>100<sp/>ms<sp/>==<sp/>6.25<sp/>fr;<sp/>rkm<sp/>had<sp/>10<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="228"><highlight class="normal"></highlight></codeline>
<codeline lineno="229"><highlight class="normal"></highlight></codeline>
<codeline lineno="230"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="231" refid="cont__ad_8h_1a288394cd94a4992bec9d3911cc875767" refkind="member"><highlight class="normal"><ref refid="cont__ad_8h_1a288394cd94a4992bec9d3911cc875767" kindref="member">cont_ad_powhist_dump</ref>(FILE<sp/>*<sp/>fp,<sp/><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r)</highlight></codeline>
<codeline lineno="232"><highlight class="normal">{</highlight></codeline>
<codeline lineno="233"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>i,<sp/>j;</highlight></codeline>
<codeline lineno="234"><highlight class="normal"></highlight></codeline>
<codeline lineno="235"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;PowHist:\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="236"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0,<sp/>j<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>CONT_AD_POWHISTSIZE;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" kindref="member">pow_hist</ref>[i]<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;\t%3d<sp/>%6d\n&quot;</highlight><highlight class="normal">,<sp/>i,<sp/>r-&gt;<ref refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" kindref="member">pow_hist</ref>[i]);</highlight></codeline>
<codeline lineno="239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>j<sp/>=<sp/>i;</highlight></codeline>
<codeline lineno="240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="241"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="242"><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;PH[%7.2f]:&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>(r-&gt;<ref refid="structcont__ad__t_1a4ed32427e6a785b571b1346c85481899" kindref="member">tot_frm</ref><sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>)<sp/>/<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>(r-&gt;<ref refid="structcont__ad__t_1a11a4bb48870007b39f8fa46e4b8f111a" kindref="member">sps</ref>));</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;=<sp/>j;<sp/>i++)</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;<sp/>%2d&quot;</highlight><highlight class="normal">,<sp/>r-&gt;<ref refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" kindref="member">pow_hist</ref>[i]);</highlight></codeline>
<codeline lineno="247"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(fp,<sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="248"><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"><sp/><sp/><sp/><sp/>fflush(fp);</highlight></codeline>
<codeline lineno="250"><highlight class="normal">}</highlight></codeline>
<codeline lineno="251"><highlight class="normal"></highlight></codeline>
<codeline lineno="252"><highlight class="normal"></highlight></codeline>
<codeline lineno="253"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="254"><highlight class="comment"><sp/>*<sp/>Compute<sp/>frame<sp/>power.<sp/><sp/>Interface<sp/>deliberately<sp/>kept<sp/>low<sp/>level<sp/>to<sp/>allow<sp/>arbitrary</highlight></codeline>
<codeline lineno="255"><highlight class="comment"><sp/>*<sp/>users<sp/>to<sp/>call<sp/>this<sp/>function<sp/>with<sp/>appropriate<sp/>data.</highlight></codeline>
<codeline lineno="256"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="258"><highlight class="normal">cont_ad_frame_pow(int16<sp/>*<sp/>buf,<sp/>int32<sp/>*<sp/>prev,<sp/>int32<sp/>spf)</highlight></codeline>
<codeline lineno="259"><highlight class="normal">{</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>sumsq,<sp/>v;</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>i;</highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>p;</highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"><sp/><sp/><sp/><sp/>sumsq<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/>p<sp/>=<sp/>*prev;</highlight></codeline>
<codeline lineno="266"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>spf;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Note:<sp/>pre-emphasis<sp/>done<sp/>to<sp/>remove<sp/>low-frequency<sp/>noise.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>v<sp/>=<sp/>(double)<sp/>(buf[i]<sp/>-<sp/>p);</highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sumsq<sp/>+=<sp/>v<sp/>*<sp/>v;</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>p<sp/>=<sp/>buf[i];</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/>*prev<sp/>=<sp/>p;</highlight></codeline>
<codeline lineno="273"><highlight class="normal"></highlight></codeline>
<codeline lineno="274"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sumsq<sp/>&lt;<sp/>spf)<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Make<sp/>sure<sp/>FRMPOW(sumsq)<sp/>&gt;=<sp/>0<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sumsq<sp/>=<sp/>spf;</highlight></codeline>
<codeline lineno="276"><highlight class="normal"></highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="278"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>PWP:<sp/>Units<sp/>changed<sp/>to<sp/>dB</highlight></codeline>
<codeline lineno="279"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="280"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>Now<sp/>the<sp/>units<sp/>of<sp/>measurement<sp/>of<sp/>an<sp/>input<sp/>sample<sp/>are<sp/>volts<sp/>(really!),</highlight></codeline>
<codeline lineno="281"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>so<sp/>the<sp/>power<sp/>in<sp/>dB<sp/>is<sp/>p<sp/>=<sp/>20*log10(samp).<sp/><sp/>Further,<sp/>we<sp/>want<sp/>the<sp/>RMS</highlight></codeline>
<codeline lineno="282"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>(root-mean-squared)<sp/>average<sp/>power<sp/>across<sp/>the<sp/>frame.</highlight></codeline>
<codeline lineno="283"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="284"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>&quot;sumsq&quot;<sp/>is<sp/>the<sp/>sum<sp/>of<sp/>the<sp/>sum<sp/>of<sp/>the<sp/>squares,<sp/>so<sp/>we<sp/>want</highlight></codeline>
<codeline lineno="285"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="286"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>i<sp/>=<sp/>20<sp/>*<sp/>log10(<sp/>sqrt<sp/>(<sp/>sumsq<sp/>/<sp/>n_samps)<sp/>)</highlight></codeline>
<codeline lineno="287"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="288"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>(Stephen<sp/>Reed&apos;s<sp/>code<sp/>actually<sp/>had<sp/></highlight></codeline>
<codeline lineno="289"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/><sp/>i<sp/>=<sp/>20<sp/>*<sp/>log10(<sp/>sqrt<sp/>(sumsq)<sp/>/<sp/>n_samps<sp/>)</highlight></codeline>
<codeline lineno="290"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/>but<sp/>this<sp/>only<sp/>produced<sp/>an<sp/>additive<sp/>error.)</highlight></codeline>
<codeline lineno="291"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*</highlight></codeline>
<codeline lineno="292"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>i<sp/>=<sp/>20<sp/>*<sp/>log10(<sp/>sqrt<sp/>(<sp/>sumsq<sp/>/<sp/>n_samps)<sp/>)</highlight></codeline>
<codeline lineno="293"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>=<sp/>20<sp/>*<sp/>log10(<sp/>(<sp/>sumsq<sp/>/<sp/>n_samps)<sp/>^<sp/>0.5<sp/>)</highlight></codeline>
<codeline lineno="294"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>=<sp/>20<sp/>*<sp/>log10(<sp/>(<sp/>sumsq<sp/>/<sp/>n_samps)<sp/>)<sp/>*<sp/>0.5<sp/>)</highlight></codeline>
<codeline lineno="295"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>=<sp/>10<sp/>*<sp/>log10(<sp/>(<sp/>sumsq<sp/>/<sp/>n_samps)<sp/>)</highlight></codeline>
<codeline lineno="296"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/><sp/><sp/>=<sp/>10<sp/>*<sp/>(<sp/>log10(<sp/>sumsq)<sp/>-<sp/>log10(n_samps)<sp/>)</highlight></codeline>
<codeline lineno="297"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>(int32)<sp/>((10.0<sp/>*<sp/>(log10(sumsq)<sp/>-<sp/>log10((</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>spf)))<sp/>+<sp/>0.5);</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>trim<sp/>lower<sp/>bound<sp/>again<sp/>to<sp/>be<sp/>safe.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/>assert(i<sp/>&lt;<sp/>97);</highlight></codeline>
<codeline lineno="302"><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(i);</highlight></codeline>
<codeline lineno="304"><highlight class="normal">}</highlight></codeline>
<codeline lineno="305"><highlight class="normal"></highlight></codeline>
<codeline lineno="306"><highlight class="normal"></highlight></codeline>
<codeline lineno="307"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="308"><highlight class="comment"><sp/>*<sp/>Classify<sp/>frame<sp/>(id=frm,<sp/>starting<sp/>at<sp/>sample<sp/>position<sp/>s)<sp/>as<sp/>sil/nonsil.<sp/><sp/>Classification</highlight></codeline>
<codeline lineno="309"><highlight class="comment"><sp/>*<sp/>done<sp/>in<sp/>isolation,<sp/>independent<sp/>of<sp/>any<sp/>other<sp/>frame,<sp/>based<sp/>only<sp/>on<sp/>power<sp/>histogram.</highlight></codeline>
<codeline lineno="310"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal">compute_frame_pow(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r,<sp/>int32<sp/>frm)</highlight></codeline>
<codeline lineno="313"><highlight class="normal">{</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>i;</highlight></codeline>
<codeline lineno="315"><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>cont_ad_frame_pow(r-&gt;<ref refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" kindref="member">adbuf</ref><sp/>+<sp/>(frm<sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>),<sp/>&amp;(r-&gt;<ref refid="structcont__ad__t_1a54e2013d9634ec473aaf79a606fb2e0f" kindref="member">prev_sample</ref>),</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>);</highlight></codeline>
<codeline lineno="318"><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" kindref="member">frm_pow</ref>[frm]<sp/>=<sp/>(char)<sp/>i;</highlight></codeline>
<codeline lineno="320"><highlight class="normal"><sp/><sp/><sp/><sp/>(r-&gt;<ref refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" kindref="member">pow_hist</ref>[i])++;</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a2168183b25add085cf3aa29ddab1c8ce" kindref="member">thresh_update</ref>--;</highlight></codeline>
<codeline lineno="322"><highlight class="normal">}</highlight></codeline>
<codeline lineno="323"><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"></highlight></codeline>
<codeline lineno="325"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>PWP:<sp/>$$$<sp/>check<sp/>this<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="327"><highlight class="comment"><sp/>*<sp/>PWP:<sp/>in<sp/>SReed&apos;s<sp/>code,<sp/>decay<sp/>was<sp/>done<sp/>by<sp/>zeroing<sp/>the<sp/>histogram,</highlight></codeline>
<codeline lineno="328"><highlight class="comment"><sp/>*<sp/>i.e.<sp/>no<sp/>history.</highlight></codeline>
<codeline lineno="329"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="331"><highlight class="normal">decay_hist(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r)</highlight></codeline>
<codeline lineno="332"><highlight class="normal">{</highlight></codeline>
<codeline lineno="333"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>i;</highlight></codeline>
<codeline lineno="334"><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>CONT_AD_POWHISTSIZE;<sp/>i++)</highlight></codeline>
<codeline lineno="336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" kindref="member">pow_hist</ref>[i]<sp/>-=<sp/>(r-&gt;<ref refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" kindref="member">pow_hist</ref>[i]<sp/>&gt;&gt;<sp/>CONT_AD_HIST_INERTIA);</highlight></codeline>
<codeline lineno="337"><highlight class="normal">}</highlight></codeline>
<codeline lineno="338"><highlight class="normal"></highlight></codeline>
<codeline lineno="339"><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="341"><highlight class="comment"><sp/>*<sp/>Find<sp/>silence<sp/>threshold<sp/>from<sp/>power<sp/>histogram.</highlight></codeline>
<codeline lineno="342"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="343"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>int32</highlight></codeline>
<codeline lineno="344"><highlight class="normal">find_thresh(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r)</highlight></codeline>
<codeline lineno="345"><highlight class="normal">{</highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>i,<sp/>j,<sp/>max,<sp/>th;</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>old_noise_level,<sp/>old_thresh_sil,<sp/>old_thresh_speech;</highlight></codeline>
<codeline lineno="348"><highlight class="normal"></highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!r-&gt;<ref refid="structcont__ad__t_1a9e23379bf649ee06ece20133316253e5" kindref="member">auto_thresh</ref>)</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="351"><highlight class="normal"></highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="353"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>Find<sp/>smallest<sp/>non-zero<sp/>histogram<sp/>entry,<sp/>but<sp/>starting<sp/>at<sp/>some<sp/>minimum<sp/>power.</highlight></codeline>
<codeline lineno="354"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>Power<sp/>lower<sp/>than<sp/>CONT_AD_MIN_NOISE<sp/>indicates<sp/>bad<sp/>A/D<sp/>input<sp/>(eg,<sp/>mic<sp/>off...).</highlight></codeline>
<codeline lineno="355"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>Too<sp/>high<sp/>a<sp/>minimum<sp/>power<sp/>is<sp/>also<sp/>bad.</highlight></codeline>
<codeline lineno="356"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1ac301114b24356aef2edccba155e3cf33" kindref="member">min_noise</ref>;</highlight></codeline>
<codeline lineno="358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(i<sp/>&lt;<sp/>CONT_AD_POWHISTSIZE)<sp/>&amp;&amp;<sp/>(r-&gt;<ref refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" kindref="member">pow_hist</ref>[i]<sp/>==<sp/>0);<sp/>i++);</highlight></codeline>
<codeline lineno="359"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&gt;<sp/>r-&gt;<ref refid="structcont__ad__t_1af3b50663565964bb18ebb9f9e0002421" kindref="member">max_noise</ref>)<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Bad<sp/>signal?<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="361"><highlight class="normal"></highlight></codeline>
<codeline lineno="362"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>PWP:<sp/>Hmmmmm....<sp/>SReed&apos;s<sp/>code<sp/>looks<sp/>over<sp/>the<sp/>lower<sp/>20<sp/>dB<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>PWP:<sp/>1/14/98<sp/><sp/>Made<sp/>to<sp/>work<sp/>like<sp/>Stephen<sp/>Reed&apos;s<sp/>code<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="364"><highlight class="normal"></highlight></codeline>
<codeline lineno="365"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>This<sp/>method<sp/>of<sp/>detecting<sp/>the<sp/>noise<sp/>level<sp/>is<sp/>VERY<sp/>unsatisfactory<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="366"><highlight class="normal"><sp/><sp/><sp/><sp/>max<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="367"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>i,<sp/>th<sp/>=<sp/>i;<sp/>(j<sp/>&lt;<sp/>CONT_AD_POWHISTSIZE)<sp/>&amp;&amp;<sp/>(j<sp/>&lt;<sp/>i<sp/>+<sp/>20);<sp/>j++)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>PWP:<sp/>was<sp/>i+6,<sp/>which<sp/>was<sp/>9<sp/>dB<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(max<sp/>&lt;<sp/>r-&gt;pow_hist[j])<sp/>{</highlight></codeline>
<codeline lineno="369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" kindref="member">pow_hist</ref>[j];</highlight></codeline>
<codeline lineno="370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>th<sp/>=<sp/>j;</highlight></codeline>
<codeline lineno="371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="373"><highlight class="normal"></highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>&quot;Don&apos;t<sp/>change<sp/>the<sp/>threshold<sp/>too<sp/>fast&quot;<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="375"><highlight class="normal"><sp/><sp/><sp/><sp/>old_noise_level<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1af60b0f78f9959a25cf7e7bf4c4aab4d7" kindref="member">noise_level</ref>;</highlight></codeline>
<codeline lineno="376"><highlight class="normal"><sp/><sp/><sp/><sp/>old_thresh_sil<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1adbbe28dca87d06a3ca8d2390d08ea83a" kindref="member">thresh_sil</ref>;</highlight></codeline>
<codeline lineno="377"><highlight class="normal"><sp/><sp/><sp/><sp/>old_thresh_speech<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a0b9333d9acc41b5bfb67f69fc22ca901" kindref="member">thresh_speech</ref>;</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>r-&gt;noise_level<sp/>=<sp/>(int32)<sp/>(th<sp/>*<sp/>r-&gt;adapt_rate<sp/>+<sp/>r-&gt;noise_level<sp/>*<sp/>(1.0<sp/>-<sp/>r-&gt;adapt_rate));<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1af60b0f78f9959a25cf7e7bf4c4aab4d7" kindref="member">noise_level</ref><sp/>=</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(int32)<sp/>(r-&gt;<ref refid="structcont__ad__t_1af60b0f78f9959a25cf7e7bf4c4aab4d7" kindref="member">noise_level</ref><sp/>+</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ac22395096037175bf9a0a1f6877e5ec5" kindref="member">adapt_rate</ref><sp/>*<sp/>(th<sp/>-<sp/>r-&gt;<ref refid="structcont__ad__t_1af60b0f78f9959a25cf7e7bf4c4aab4d7" kindref="member">noise_level</ref>)<sp/>+<sp/>0.5);</highlight></codeline>
<codeline lineno="382"><highlight class="normal"></highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>update<sp/>thresholds<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1adbbe28dca87d06a3ca8d2390d08ea83a" kindref="member">thresh_sil</ref><sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1af60b0f78f9959a25cf7e7bf4c4aab4d7" kindref="member">noise_level</ref><sp/>+<sp/>r-&gt;<ref refid="structcont__ad__t_1a74a6f56fb4cbde7fc789c9b463cf2f8f" kindref="member">delta_sil</ref>;</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a0b9333d9acc41b5bfb67f69fc22ca901" kindref="member">thresh_speech</ref><sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1af60b0f78f9959a25cf7e7bf4c4aab4d7" kindref="member">noise_level</ref><sp/>+<sp/>r-&gt;<ref refid="structcont__ad__t_1afca0f69a21d9f28c9610fcefc0e7cb10" kindref="member">delta_speech</ref>;</highlight></codeline>
<codeline lineno="386"><highlight class="normal"></highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>)<sp/>{</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%7.2fs<sp/>%8df:<sp/>NoisePeak:<sp/>%d,<sp/>Noiselevel:<sp/>%d<sp/>-&gt;<sp/>%d,<sp/>Th-Sil:<sp/>%d<sp/>-&gt;<sp/>%d,<sp/>Th-Sp:<sp/>%d<sp/>-&gt;<sp/>%d\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>(r-&gt;<ref refid="structcont__ad__t_1a4ed32427e6a785b571b1346c85481899" kindref="member">tot_frm</ref><sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>)<sp/>/<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>(r-&gt;<ref refid="structcont__ad__t_1a11a4bb48870007b39f8fa46e4b8f111a" kindref="member">sps</ref>),</highlight></codeline>
<codeline lineno="391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a4ed32427e6a785b571b1346c85481899" kindref="member">tot_frm</ref>,<sp/>th,<sp/>old_noise_level,<sp/>r-&gt;<ref refid="structcont__ad__t_1af60b0f78f9959a25cf7e7bf4c4aab4d7" kindref="member">noise_level</ref>,</highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>old_thresh_sil,<sp/>r-&gt;<ref refid="structcont__ad__t_1adbbe28dca87d06a3ca8d2390d08ea83a" kindref="member">thresh_sil</ref>,<sp/>old_thresh_speech,</highlight></codeline>
<codeline lineno="393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a0b9333d9acc41b5bfb67f69fc22ca901" kindref="member">thresh_speech</ref>);</highlight></codeline>
<codeline lineno="394"><highlight class="normal"></highlight></codeline>
<codeline lineno="395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="cont__ad_8h_1a288394cd94a4992bec9d3911cc875767" kindref="member">cont_ad_powhist_dump</ref>(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/>r);</highlight></codeline>
<codeline lineno="396"><highlight class="normal"></highlight></codeline>
<codeline lineno="397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fflush(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>);</highlight></codeline>
<codeline lineno="398"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="399"><highlight class="normal"></highlight></codeline>
<codeline lineno="400"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="401"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>PWP:<sp/>in<sp/>SReed&apos;s<sp/>original,<sp/>he<sp/>cleared<sp/>the<sp/>histogram<sp/>here.</highlight></codeline>
<codeline lineno="402"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>I<sp/>can&apos;t<sp/>fathom<sp/>why.</highlight></codeline>
<codeline lineno="403"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="404"><highlight class="normal"></highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="406"><highlight class="normal">}</highlight></codeline>
<codeline lineno="407"><highlight class="normal"></highlight></codeline>
<codeline lineno="408"><highlight class="normal"></highlight></codeline>
<codeline lineno="409"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="410"><highlight class="comment"><sp/>*<sp/>Silence<sp/>to<sp/>speech<sp/>transition</highlight></codeline>
<codeline lineno="411"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="412"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="413"><highlight class="normal">sil2speech_transition(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*r,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>frm)</highlight></codeline>
<codeline lineno="414"><highlight class="normal">{</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structspseg__t" kindref="compound">spseg_t</ref><sp/>*seg;</highlight></codeline>
<codeline lineno="416"><highlight class="normal"></highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Speech<sp/>detected;<sp/>create<sp/>speech<sp/>segment<sp/>description<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/>seg<sp/>=<sp/>malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(*seg));</highlight></codeline>
<codeline lineno="419"><highlight class="normal"></highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/>seg-&gt;startfrm<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref><sp/>-<sp/>r-&gt;<ref refid="structcont__ad__t_1a0d42e3ac6c1e5c59c86a40f4cf26a861" kindref="member">leader</ref>;</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(seg-&gt;startfrm<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;startfrm<sp/>+=<sp/>CONT_AD_ADFRMSIZE;</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/>seg-&gt;nfrm<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a0d42e3ac6c1e5c59c86a40f4cf26a861" kindref="member">leader</ref><sp/>+<sp/>r-&gt;<ref refid="structcont__ad__t_1a7c61513f48e8fbc9ab6b57db66dad7b9" kindref="member">winsize</ref>;</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/>seg-&gt;next<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="425"><highlight class="normal"></highlight></codeline>
<codeline lineno="426"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!r-&gt;<ref refid="structcont__ad__t_1abffe61140bc2a02ae4222183b3ef6159" kindref="member">spseg_head</ref>)</highlight></codeline>
<codeline lineno="427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1abffe61140bc2a02ae4222183b3ef6159" kindref="member">spseg_head</ref><sp/>=<sp/>seg;</highlight></codeline>
<codeline lineno="428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ac77e8f8bd27cea3b99238d9663455972" kindref="member">spseg_tail</ref>-&gt;next<sp/>=<sp/>seg;</highlight></codeline>
<codeline lineno="430"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ac77e8f8bd27cea3b99238d9663455972" kindref="member">spseg_tail</ref><sp/>=<sp/>seg;</highlight></codeline>
<codeline lineno="431"><highlight class="normal"></highlight></codeline>
<codeline lineno="432"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" kindref="member">tail_state</ref><sp/>=<sp/>CONT_AD_STATE_SPEECH;</highlight></codeline>
<codeline lineno="433"><highlight class="normal"></highlight></codeline>
<codeline lineno="434"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>)<sp/>{</highlight></codeline>
<codeline lineno="435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>n;</highlight></codeline>
<codeline lineno="436"><highlight class="normal"></highlight></codeline>
<codeline lineno="437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Where<sp/>(in<sp/>absolute<sp/>time)<sp/>this<sp/>speech<sp/>segment<sp/>starts<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>frm<sp/>-<sp/>seg-&gt;startfrm;</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>+=<sp/>CONT_AD_ADFRMSIZE;</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a4ed32427e6a785b571b1346c85481899" kindref="member">tot_frm</ref><sp/>-<sp/>n<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="442"><highlight class="normal"></highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%7.2fs<sp/>%8d[%3d]f:<sp/>Sil<sp/>-&gt;<sp/>Sp<sp/>detect;<sp/>seg<sp/>start:<sp/>%7.2fs<sp/>%8d\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>(r-&gt;<ref refid="structcont__ad__t_1a4ed32427e6a785b571b1346c85481899" kindref="member">tot_frm</ref><sp/>*</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>)<sp/>/</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>(r-&gt;<ref refid="structcont__ad__t_1a11a4bb48870007b39f8fa46e4b8f111a" kindref="member">sps</ref>),</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a4ed32427e6a785b571b1346c85481899" kindref="member">tot_frm</ref>,<sp/>frm,</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>(n<sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>)<sp/>/<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>(r-&gt;<ref refid="structcont__ad__t_1a11a4bb48870007b39f8fa46e4b8f111a" kindref="member">sps</ref>),<sp/>n);</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="451"><highlight class="normal"></highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Now<sp/>in<sp/>SPEECH<sp/>state;<sp/>want<sp/>to<sp/>look<sp/>for<sp/>silence<sp/>from<sp/>end<sp/>of<sp/>this<sp/>window<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref><sp/>=<sp/>frm;</highlight></codeline>
<codeline lineno="455"><highlight class="normal"></highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Count<sp/>#sil<sp/>frames<sp/>remaining<sp/>in<sp/>reduced<sp/>window<sp/>(of<sp/>1<sp/>frame)<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref><sp/>=<sp/>(r-&gt;<ref refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" kindref="member">frm_pow</ref>[frm]<sp/>&lt;=<sp/>r-&gt;<ref refid="structcont__ad__t_1adbbe28dca87d06a3ca8d2390d08ea83a" kindref="member">thresh_sil</ref>)<sp/>?<sp/>1<sp/>:<sp/>0;</highlight></codeline>
<codeline lineno="458"><highlight class="normal">}</highlight></codeline>
<codeline lineno="459"><highlight class="normal"></highlight></codeline>
<codeline lineno="460"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="461"><highlight class="comment"><sp/>*<sp/>Speech<sp/>to<sp/>silence<sp/>transition</highlight></codeline>
<codeline lineno="462"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="463"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="464"><highlight class="normal">speech2sil_transition(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*r,<sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>frm)</highlight></codeline>
<codeline lineno="465"><highlight class="normal">{</highlight></codeline>
<codeline lineno="466"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>f;</highlight></codeline>
<codeline lineno="467"><highlight class="normal"></highlight></codeline>
<codeline lineno="468"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>End<sp/>of<sp/>speech<sp/>detected;<sp/>speech-&gt;sil<sp/>transition<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="469"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ac77e8f8bd27cea3b99238d9663455972" kindref="member">spseg_tail</ref>-&gt;nfrm<sp/>+=<sp/>r-&gt;<ref refid="structcont__ad__t_1aa15db1e9fbb0048225521555ab8d9388" kindref="member">trailer</ref>;</highlight></codeline>
<codeline lineno="470"><highlight class="normal"></highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" kindref="member">tail_state</ref><sp/>=<sp/>CONT_AD_STATE_SIL;</highlight></codeline>
<codeline lineno="472"><highlight class="normal"></highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>)<sp/>{</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>n;</highlight></codeline>
<codeline lineno="475"><highlight class="normal"></highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Where<sp/>(in<sp/>absolute<sp/>time)<sp/>this<sp/>speech<sp/>segment<sp/>ends<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1ac77e8f8bd27cea3b99238d9663455972" kindref="member">spseg_tail</ref>-&gt;startfrm<sp/>+<sp/>r-&gt;<ref refid="structcont__ad__t_1ac77e8f8bd27cea3b99238d9663455972" kindref="member">spseg_tail</ref>-&gt;nfrm<sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n<sp/>&gt;=<sp/>CONT_AD_ADFRMSIZE)</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>-=<sp/>CONT_AD_ADFRMSIZE;</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>frm<sp/>-<sp/>n;</highlight></codeline>
<codeline lineno="481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>+=<sp/>CONT_AD_ADFRMSIZE;</highlight></codeline>
<codeline lineno="483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>n<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a4ed32427e6a785b571b1346c85481899" kindref="member">tot_frm</ref><sp/>-<sp/>n;</highlight></codeline>
<codeline lineno="484"><highlight class="normal"></highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,</highlight></codeline>
<codeline lineno="486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%7.2fs<sp/>%8d[%3d]f:<sp/>Sp<sp/>-&gt;<sp/>Sil<sp/>detect;<sp/>seg<sp/>end:<sp/>%7.2fs<sp/>%8d\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>(r-&gt;<ref refid="structcont__ad__t_1a4ed32427e6a785b571b1346c85481899" kindref="member">tot_frm</ref><sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>)<sp/>/</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>(r-&gt;<ref refid="structcont__ad__t_1a11a4bb48870007b39f8fa46e4b8f111a" kindref="member">sps</ref>),<sp/>r-&gt;<ref refid="structcont__ad__t_1a4ed32427e6a785b571b1346c85481899" kindref="member">tot_frm</ref>,<sp/>frm,</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>(n<sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>)<sp/>/<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>(r-&gt;<ref refid="structcont__ad__t_1a11a4bb48870007b39f8fa46e4b8f111a" kindref="member">sps</ref>),<sp/>n);</highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="491"><highlight class="normal"></highlight></codeline>
<codeline lineno="492"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Now<sp/>in<sp/>SILENCE<sp/>state;<sp/>start<sp/>looking<sp/>for<sp/>speech<sp/>trailer+leader<sp/>frames<sp/>later<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="493"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref><sp/>-=<sp/>(r-&gt;<ref refid="structcont__ad__t_1aa15db1e9fbb0048225521555ab8d9388" kindref="member">trailer</ref><sp/>+<sp/>r-&gt;<ref refid="structcont__ad__t_1a0d42e3ac6c1e5c59c86a40f4cf26a861" kindref="member">leader</ref><sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="494"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref><sp/>+=<sp/>(r-&gt;<ref refid="structcont__ad__t_1aa15db1e9fbb0048225521555ab8d9388" kindref="member">trailer</ref><sp/>+<sp/>r-&gt;<ref refid="structcont__ad__t_1a0d42e3ac6c1e5c59c86a40f4cf26a861" kindref="member">leader</ref><sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="495"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref><sp/>&gt;=<sp/>CONT_AD_ADFRMSIZE)</highlight></codeline>
<codeline lineno="496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref><sp/>-=<sp/>CONT_AD_ADFRMSIZE;</highlight></codeline>
<codeline lineno="497"><highlight class="normal"></highlight></codeline>
<codeline lineno="498"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Count<sp/>#speech<sp/>frames<sp/>remaining<sp/>in<sp/>reduced<sp/>window<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="500"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(f<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref>;;)<sp/>{</highlight></codeline>
<codeline lineno="501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" kindref="member">frm_pow</ref>[f]<sp/>&gt;=<sp/>r-&gt;<ref refid="structcont__ad__t_1a0b9333d9acc41b5bfb67f69fc22ca901" kindref="member">thresh_speech</ref>)</highlight></codeline>
<codeline lineno="502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref>++;</highlight></codeline>
<codeline lineno="503"><highlight class="normal"></highlight></codeline>
<codeline lineno="504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(f<sp/>==<sp/>frm)</highlight></codeline>
<codeline lineno="505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="506"><highlight class="normal"></highlight></codeline>
<codeline lineno="507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f++;</highlight></codeline>
<codeline lineno="508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(f<sp/>&gt;=<sp/>CONT_AD_ADFRMSIZE)</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="511"><highlight class="normal">}</highlight></codeline>
<codeline lineno="512"><highlight class="normal"></highlight></codeline>
<codeline lineno="513"><highlight class="normal"></highlight></codeline>
<codeline lineno="514"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="515"><highlight class="comment"><sp/>*<sp/>Main<sp/>silence/speech<sp/>region<sp/>detection<sp/>routine.<sp/><sp/>If<sp/>currently<sp/>in</highlight></codeline>
<codeline lineno="516"><highlight class="comment"><sp/>*<sp/>SILENCE<sp/>state,<sp/>switch<sp/>to<sp/>SPEECH<sp/>state<sp/>if<sp/>a<sp/>window<sp/>(r-&gt;winsize)</highlight></codeline>
<codeline lineno="517"><highlight class="comment"><sp/>*<sp/>of<sp/>frames<sp/>is<sp/>mostly<sp/>non-silence.<sp/><sp/>If<sp/>in<sp/>SPEECH<sp/>state,<sp/>switch<sp/>to</highlight></codeline>
<codeline lineno="518"><highlight class="comment"><sp/>*<sp/>SILENCE<sp/>state<sp/>if<sp/>the<sp/>window<sp/>is<sp/>mostly<sp/>silence.</highlight></codeline>
<codeline lineno="519"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="520"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="521"><highlight class="normal">boundary_detect(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r,<sp/>int32<sp/>frm)</highlight></codeline>
<codeline lineno="522"><highlight class="normal">{</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/>assert(r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref><sp/>&gt;=<sp/>0);</highlight></codeline>
<codeline lineno="524"><highlight class="normal"></highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref>++;</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" kindref="member">tail_state</ref><sp/>==<sp/>CONT_AD_STATE_SIL)<sp/>{</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" kindref="member">frm_pow</ref>[frm]<sp/>&gt;=<sp/>r-&gt;<ref refid="structcont__ad__t_1a0b9333d9acc41b5bfb67f69fc22ca901" kindref="member">thresh_speech</ref>)</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref>++;</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" kindref="member">frm_pow</ref>[frm]<sp/>&lt;=<sp/>r-&gt;<ref refid="structcont__ad__t_1adbbe28dca87d06a3ca8d2390d08ea83a" kindref="member">thresh_sil</ref>)</highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref>++;</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="534"><highlight class="normal"></highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>)<sp/>{</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%7.2fs<sp/>%8d[%3d]f:<sp/>P:<sp/>%2d,<sp/>N:<sp/>%2d,<sp/>T+:<sp/>%2d,<sp/>T-:<sp/>%2d,<sp/>#O:<sp/>%2d,<sp/>%s\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>(r-&gt;<ref refid="structcont__ad__t_1a4ed32427e6a785b571b1346c85481899" kindref="member">tot_frm</ref><sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>)<sp/>/<sp/>(</highlight><highlight class="keywordtype">double</highlight><highlight class="normal">)<sp/>(r-&gt;<ref refid="structcont__ad__t_1a11a4bb48870007b39f8fa46e4b8f111a" kindref="member">sps</ref>),</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a4ed32427e6a785b571b1346c85481899" kindref="member">tot_frm</ref>,<sp/>frm,<sp/>r-&gt;<ref refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" kindref="member">frm_pow</ref>[frm],<sp/>r-&gt;<ref refid="structcont__ad__t_1af60b0f78f9959a25cf7e7bf4c4aab4d7" kindref="member">noise_level</ref>,</highlight></codeline>
<codeline lineno="540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a0b9333d9acc41b5bfb67f69fc22ca901" kindref="member">thresh_speech</ref>,<sp/>r-&gt;<ref refid="structcont__ad__t_1adbbe28dca87d06a3ca8d2390d08ea83a" kindref="member">thresh_sil</ref>,<sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref>,</highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(r-&gt;<ref refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" kindref="member">tail_state</ref><sp/>==<sp/>CONT_AD_STATE_SIL)<sp/>?<sp/></highlight><highlight class="stringliteral">&quot;--&quot;</highlight><highlight class="normal"><sp/>:<sp/></highlight><highlight class="stringliteral">&quot;Sp&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="543"><highlight class="normal"></highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref><sp/>&lt;<sp/>r-&gt;<ref refid="structcont__ad__t_1a7c61513f48e8fbc9ab6b57db66dad7b9" kindref="member">winsize</ref>)<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Not<sp/>reached<sp/>full<sp/>analysis<sp/>window<sp/>size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/>assert(r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref><sp/>==<sp/>r-&gt;<ref refid="structcont__ad__t_1a7c61513f48e8fbc9ab6b57db66dad7b9" kindref="member">winsize</ref>);</highlight></codeline>
<codeline lineno="547"><highlight class="normal"></highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" kindref="member">tail_state</ref><sp/>==<sp/>CONT_AD_STATE_SIL)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Currently<sp/>in<sp/>SILENCE<sp/>state<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" kindref="member">n_frm</ref><sp/>&gt;=<sp/>r-&gt;<ref refid="structcont__ad__t_1a7c61513f48e8fbc9ab6b57db66dad7b9" kindref="member">winsize</ref><sp/>+<sp/>r-&gt;<ref refid="structcont__ad__t_1a0d42e3ac6c1e5c59c86a40f4cf26a861" kindref="member">leader</ref></highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref><sp/>&gt;=<sp/>r-&gt;<ref refid="structcont__ad__t_1a1b0bb7e53a2bf537ed362badddca341b" kindref="member">speech_onset</ref>)<sp/>{</highlight></codeline>
<codeline lineno="551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sil2speech_transition(r,<sp/>frm);</highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="554"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref><sp/>&gt;=<sp/>r-&gt;<ref refid="structcont__ad__t_1a9f5e138f4b79b59bf4daa5603d171165" kindref="member">sil_onset</ref>)<sp/>{</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speech2sil_transition(r,<sp/>frm);</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>In<sp/>speech<sp/>state,<sp/>and<sp/>staying<sp/>there;<sp/>add<sp/>this<sp/>frame<sp/>to<sp/>segment<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ac77e8f8bd27cea3b99238d9663455972" kindref="member">spseg_tail</ref>-&gt;nfrm++;</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="562"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="563"><highlight class="normal"></highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="565"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>Get<sp/>rid<sp/>of<sp/>oldest<sp/>frame<sp/>in<sp/>analysis<sp/>window.<sp/><sp/>Not<sp/>quite<sp/>correct;</highlight></codeline>
<codeline lineno="566"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>thresholds<sp/>could<sp/>have<sp/>changed<sp/>over<sp/>the<sp/>window;<sp/>should<sp/>preserve</highlight></codeline>
<codeline lineno="567"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>the<sp/>original<sp/>speech/silence<sp/>label<sp/>for<sp/>the<sp/>frame<sp/>and<sp/>undo<sp/>it.<sp/><sp/>Later..</highlight></codeline>
<codeline lineno="568"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" kindref="member">tail_state</ref><sp/>==<sp/>CONT_AD_STATE_SIL)<sp/>{</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" kindref="member">frm_pow</ref>[r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref>]<sp/>&gt;=<sp/>r-&gt;<ref refid="structcont__ad__t_1a0b9333d9acc41b5bfb67f69fc22ca901" kindref="member">thresh_speech</ref>)<sp/>{</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref><sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref>--;</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="575"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" kindref="member">frm_pow</ref>[r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref>]<sp/>&lt;=<sp/>r-&gt;<ref refid="structcont__ad__t_1adbbe28dca87d06a3ca8d2390d08ea83a" kindref="member">thresh_sil</ref>)<sp/>{</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref><sp/>&gt;<sp/>0)</highlight></codeline>
<codeline lineno="578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref>--;</highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref>--;</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref>++;</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref><sp/>&gt;=<sp/>CONT_AD_ADFRMSIZE)</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="585"><highlight class="normal"></highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>)</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fflush(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>);</highlight></codeline>
<codeline lineno="588"><highlight class="normal">}</highlight></codeline>
<codeline lineno="589"><highlight class="normal"></highlight></codeline>
<codeline lineno="590"><highlight class="normal"></highlight></codeline>
<codeline lineno="591"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>int32</highlight></codeline>
<codeline lineno="592"><highlight class="normal">max_siglvl(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r,<sp/>int32<sp/>startfrm,<sp/>int32<sp/>nfrm)</highlight></codeline>
<codeline lineno="593"><highlight class="normal">{</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>siglvl,<sp/>i,<sp/>f;</highlight></codeline>
<codeline lineno="595"><highlight class="normal"></highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/>siglvl<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nfrm<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0,<sp/>f<sp/>=<sp/>startfrm;<sp/>i<sp/>&lt;<sp/>nfrm;<sp/>i++,<sp/>f++)<sp/>{</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(f<sp/>&gt;=<sp/>CONT_AD_ADFRMSIZE)</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>-=<sp/>CONT_AD_ADFRMSIZE;</highlight></codeline>
<codeline lineno="601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" kindref="member">frm_pow</ref>[f]<sp/>&gt;<sp/>siglvl)</highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>siglvl<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" kindref="member">frm_pow</ref>[f];</highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>siglvl;</highlight></codeline>
<codeline lineno="606"><highlight class="normal">}</highlight></codeline>
<codeline lineno="607"><highlight class="normal"></highlight></codeline>
<codeline lineno="608"><highlight class="normal"></highlight></codeline>
<codeline lineno="609"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>0</highlight></codeline>
<codeline lineno="610"><highlight class="preprocessor"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="611"><highlight class="comment"><sp/>*<sp/>RKM(2005/01/31):<sp/>Where<sp/>did<sp/>this<sp/>come<sp/>from?<sp/><sp/>If<sp/>needed,<sp/>it<sp/>should<sp/>be<sp/>called</highlight></codeline>
<codeline lineno="612"><highlight class="comment"><sp/>*<sp/>cont_ad_get_audio_data.</highlight></codeline>
<codeline lineno="613"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="614"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="615"><highlight class="normal">get_audio_data(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r,<sp/>int16<sp/>*<sp/>buf,<sp/>int32<sp/>max)</highlight></codeline>
<codeline lineno="616"><highlight class="normal">{</highlight></codeline>
<codeline lineno="617"><highlight class="normal">}</highlight></codeline>
<codeline lineno="618"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="619"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="620"><highlight class="normal"></highlight></codeline>
<codeline lineno="621"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="622"><highlight class="normal">cont_ad_read_log(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r,<sp/>int32<sp/>retval)</highlight></codeline>
<codeline lineno="623"><highlight class="normal">{</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structspseg__t" kindref="compound">spseg_t</ref><sp/>*seg;</highlight></codeline>
<codeline lineno="625"><highlight class="normal"></highlight></codeline>
<codeline lineno="626"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;return<sp/>from<sp/>cont_ad_read()<sp/>-&gt;<sp/>%d:\n&quot;</highlight><highlight class="normal">,<sp/>retval);</highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\tstate:<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>r-&gt;<ref refid="structcont__ad__t_1a5d9420ea711733d1eea9b8f29a638fdb" kindref="member">state</ref>);</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\tread_ts:<sp/>%d<sp/>(%.2fs)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a7b71e87abfcb3ca4ae73af34c86f955e" kindref="member">read_ts</ref>,<sp/>(float32)<sp/>r-&gt;<ref refid="structcont__ad__t_1a7b71e87abfcb3ca4ae73af34c86f955e" kindref="member">read_ts</ref><sp/>/<sp/>(float32)<sp/>r-&gt;<ref refid="structcont__ad__t_1a11a4bb48870007b39f8fa46e4b8f111a" kindref="member">sps</ref>);</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\tseglen:<sp/>%d<sp/>(%.2fs)\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a478939247e09a8ae142c8996ec17d8c8" kindref="member">seglen</ref>,<sp/>(float32)<sp/>r-&gt;<ref refid="structcont__ad__t_1a478939247e09a8ae142c8996ec17d8c8" kindref="member">seglen</ref><sp/>/<sp/>(float32)<sp/>r-&gt;<ref refid="structcont__ad__t_1a11a4bb48870007b39f8fa46e4b8f111a" kindref="member">sps</ref>);</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\tsiglvl:<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>r-&gt;<ref refid="structcont__ad__t_1a5524c052dcd0a3d1a1c3b1fc2134b62e" kindref="member">siglvl</ref>);</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\theadfrm:<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>r-&gt;<ref refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" kindref="member">headfrm</ref>);</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\tn_frm:<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>r-&gt;<ref refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" kindref="member">n_frm</ref>);</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\tn_sample:<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>r-&gt;<ref refid="structcont__ad__t_1a7ae5362560d9edfa6c16555285487a7a" kindref="member">n_sample</ref>);</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\twin_startfrm:<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref>);</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\twin_validfrm:<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref>);</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\tnoise_level:<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>r-&gt;<ref refid="structcont__ad__t_1af60b0f78f9959a25cf7e7bf4c4aab4d7" kindref="member">noise_level</ref>);</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\tthresh_sil:<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>r-&gt;<ref refid="structcont__ad__t_1adbbe28dca87d06a3ca8d2390d08ea83a" kindref="member">thresh_sil</ref>);</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\tthresh_speech:<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>r-&gt;<ref refid="structcont__ad__t_1a0b9333d9acc41b5bfb67f69fc22ca901" kindref="member">thresh_speech</ref>);</highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\tn_other:<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref>);</highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\ttail_state:<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>r-&gt;<ref refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" kindref="member">tail_state</ref>);</highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\ttot_frm:<sp/>%d\n&quot;</highlight><highlight class="normal">,<sp/>r-&gt;<ref refid="structcont__ad__t_1a4ed32427e6a785b571b1346c85481899" kindref="member">tot_frm</ref>);</highlight></codeline>
<codeline lineno="644"><highlight class="normal"></highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\tspseg:&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(seg<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1abffe61140bc2a02ae4222183b3ef6159" kindref="member">spseg_head</ref>;<sp/>seg;<sp/>seg<sp/>=<sp/>seg-&gt;next)</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;<sp/>%d[%d]&quot;</highlight><highlight class="normal">,<sp/>seg-&gt;startfrm,<sp/>seg-&gt;nfrm);</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="649"><highlight class="normal"></highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/>fflush(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>);</highlight></codeline>
<codeline lineno="651"><highlight class="normal">}</highlight></codeline>
<codeline lineno="652"><highlight class="normal"></highlight></codeline>
<codeline lineno="653"><highlight class="normal"></highlight></codeline>
<codeline lineno="654"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="655"><highlight class="comment"><sp/>*<sp/>Copy<sp/>data<sp/>from<sp/>r-&gt;adbuf[sf],<sp/>for<sp/>nf<sp/>frames,<sp/>into<sp/>buf.</highlight></codeline>
<codeline lineno="656"><highlight class="comment"><sp/>*<sp/>All<sp/>length<sp/>checks<sp/>must<sp/>have<sp/>been<sp/>completed<sp/>before<sp/>this<sp/>call;<sp/>hence,<sp/>this</highlight></codeline>
<codeline lineno="657"><highlight class="comment"><sp/>*<sp/>function<sp/>will<sp/>copy<sp/>exactly<sp/>the<sp/>specified<sp/>number<sp/>of<sp/>frames.</highlight></codeline>
<codeline lineno="658"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="659"><highlight class="comment"><sp/>*<sp/>Return<sp/>value:<sp/>Index<sp/>of<sp/>frame<sp/>just<sp/>after<sp/>the<sp/>segment<sp/>copied,<sp/>possibly<sp/>wrapped</highlight></codeline>
<codeline lineno="660"><highlight class="comment"><sp/>*<sp/>around<sp/>to<sp/>0.</highlight></codeline>
<codeline lineno="661"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="662"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>int32</highlight></codeline>
<codeline lineno="663"><highlight class="normal">buf_copy(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r,<sp/>int32<sp/>sf,<sp/>int32<sp/>nf,<sp/>int16<sp/>*<sp/>buf)</highlight></codeline>
<codeline lineno="664"><highlight class="normal">{</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>f,<sp/>l;</highlight></codeline>
<codeline lineno="666"><highlight class="normal"></highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/>assert((sf<sp/>&gt;=<sp/>0)<sp/>&amp;&amp;<sp/>(sf<sp/>&lt;<sp/>CONT_AD_ADFRMSIZE));</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/>assert(nf<sp/>&gt;=<sp/>0);</highlight></codeline>
<codeline lineno="669"><highlight class="normal"></highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(sf<sp/>+<sp/>nf<sp/>&gt;<sp/>CONT_AD_ADFRMSIZE)<sp/>{</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Amount<sp/>to<sp/>be<sp/>copied<sp/>wraps<sp/>around<sp/>adbuf;<sp/>copy<sp/>in<sp/>two<sp/>stages<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>CONT_AD_ADFRMSIZE<sp/>-<sp/>sf;</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>l<sp/>=<sp/>(f<sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>);</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(buf,<sp/>r-&gt;<ref refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" kindref="member">adbuf</ref><sp/>+<sp/>(sf<sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>),<sp/>l<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(int16));</highlight></codeline>
<codeline lineno="675"><highlight class="normal"></highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>)<sp/>{</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,</highlight></codeline>
<codeline lineno="678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;return<sp/>%d<sp/>speech<sp/>frames<sp/>[%d..%d];<sp/>%d<sp/>samples\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f,<sp/>sf,<sp/>sf<sp/>+<sp/>f<sp/>-<sp/>1,<sp/>l);</highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="681"><highlight class="normal"></highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buf<sp/>+=<sp/>l;</highlight></codeline>
<codeline lineno="683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sf<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nf<sp/>-=<sp/>f;</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="686"><highlight class="normal"></highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nf<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>l<sp/>=<sp/>(nf<sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>);</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(buf,<sp/>r-&gt;<ref refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" kindref="member">adbuf</ref><sp/>+<sp/>(sf<sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>),<sp/>l<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(int16));</highlight></codeline>
<codeline lineno="690"><highlight class="normal"></highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>)<sp/>{</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;return<sp/>%d<sp/>speech<sp/>frames<sp/>[%d..%d];<sp/>%d<sp/>samples\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nf,<sp/>sf,<sp/>sf<sp/>+<sp/>nf<sp/>-<sp/>1,<sp/>l);</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="697"><highlight class="normal"></highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((sf<sp/>+<sp/>nf)<sp/>&gt;=<sp/>CONT_AD_ADFRMSIZE)<sp/>{</highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assert((sf<sp/>+<sp/>nf)<sp/>==<sp/>CONT_AD_ADFRMSIZE);</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(sf<sp/>+<sp/>nf);</highlight></codeline>
<codeline lineno="704"><highlight class="normal">}</highlight></codeline>
<codeline lineno="705"><highlight class="normal"></highlight></codeline>
<codeline lineno="706"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="707" refid="cont__ad_8h_1a680721acc14ac191bbae3a4940ed357d" refkind="member"><highlight class="normal"><ref refid="cont__ad_8h_1a680721acc14ac191bbae3a4940ed357d" kindref="member">cont_ad_buffer_space</ref>(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*r)</highlight></codeline>
<codeline lineno="708"><highlight class="normal">{</highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>r-&gt;<ref refid="structcont__ad__t_1a5c6edc6be287f3ae013c59fef90cb4bd" kindref="member">adbufsize</ref><sp/>-<sp/>r-&gt;<ref refid="structcont__ad__t_1a7ae5362560d9edfa6c16555285487a7a" kindref="member">n_sample</ref>;</highlight></codeline>
<codeline lineno="710"><highlight class="normal">}</highlight></codeline>
<codeline lineno="711"><highlight class="normal"></highlight></codeline>
<codeline lineno="712"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="713"><highlight class="comment"><sp/>*<sp/>Read<sp/>as<sp/>much<sp/>data<sp/>as<sp/>possible<sp/>from<sp/>r-&gt;adfunc<sp/>into<sp/>r-&gt;adbuf.</highlight></codeline>
<codeline lineno="714"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="715"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>int32</highlight></codeline>
<codeline lineno="716"><highlight class="normal">cont_ad_read_internal(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*r,<sp/>int16<sp/>*buf,<sp/>int32<sp/>max)</highlight></codeline>
<codeline lineno="717"><highlight class="normal">{</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>head,<sp/>tail,<sp/>len,<sp/>l;</highlight></codeline>
<codeline lineno="719"><highlight class="normal"></highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="721"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>First<sp/>read<sp/>as<sp/>much<sp/>of<sp/>raw<sp/>A/D<sp/>as<sp/>possible<sp/>and<sp/>available.<sp/><sp/>adbuf<sp/>is<sp/>not</highlight></codeline>
<codeline lineno="722"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>really<sp/>a<sp/>circular<sp/>buffer,<sp/>so<sp/>may<sp/>have<sp/>to<sp/>read<sp/>in<sp/>two<sp/>steps<sp/>for<sp/>wrapping</highlight></codeline>
<codeline lineno="723"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>around.</highlight></codeline>
<codeline lineno="724"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/>head<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" kindref="member">headfrm</ref><sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>;</highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/>tail<sp/>=<sp/>head<sp/>+<sp/>r-&gt;<ref refid="structcont__ad__t_1a7ae5362560d9edfa6c16555285487a7a" kindref="member">n_sample</ref>;</highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/>len<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a7ae5362560d9edfa6c16555285487a7a" kindref="member">n_sample</ref><sp/>-<sp/>(r-&gt;<ref refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" kindref="member">n_frm</ref><sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>);<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>#partial<sp/>frame<sp/>samples<sp/>at<sp/>the<sp/>tail<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="728"><highlight class="normal"><sp/><sp/><sp/><sp/>assert((len<sp/>&gt;=<sp/>0)<sp/>&amp;&amp;<sp/>(len<sp/>&lt;<sp/>r-&gt;spf));</highlight></codeline>
<codeline lineno="729"><highlight class="normal"></highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((tail<sp/>&lt;<sp/>r-&gt;adbufsize)<sp/>&amp;&amp;<sp/>(!r-&gt;<ref refid="structcont__ad__t_1af7b9044b76ed3b86ce74e4e7215ca4c3" kindref="member">eof</ref>))<sp/>{</highlight></codeline>
<codeline lineno="731"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;adfunc)<sp/>{</highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((l<sp/>=</highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(*(r-&gt;adfunc))<sp/>(r-&gt;<ref refid="structcont__ad__t_1aae5b9d977e62424b0cf0e245485b20a0" kindref="member">ad</ref>,<sp/>r-&gt;<ref refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" kindref="member">adbuf</ref><sp/>+<sp/>tail,</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a5c6edc6be287f3ae013c59fef90cb4bd" kindref="member">adbufsize</ref><sp/>-<sp/>tail))<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1af7b9044b76ed3b86ce74e4e7215ca4c3" kindref="member">eof</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>l<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>l<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a5c6edc6be287f3ae013c59fef90cb4bd" kindref="member">adbufsize</ref><sp/>-<sp/>tail;</highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(l<sp/>&gt;<sp/>max)<sp/>{</highlight></codeline>
<codeline lineno="742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>l<sp/>=<sp/>max;</highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max<sp/>-=<sp/>l;</highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(r-&gt;<ref refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" kindref="member">adbuf</ref><sp/>+<sp/>tail,<sp/>buf,<sp/>l<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(int16));</highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buf<sp/>+=<sp/>l;</highlight></codeline>
<codeline lineno="750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((l<sp/>&gt;<sp/>0)<sp/>&amp;&amp;<sp/>r-&gt;<ref refid="structcont__ad__t_1af8cd2a7e0ef0f4e2c825c7812a091f9c" kindref="member">rawfp</ref>)<sp/>{</highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fwrite(r-&gt;<ref refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" kindref="member">adbuf</ref><sp/>+<sp/>tail,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(int16),<sp/>l,<sp/>r-&gt;<ref refid="structcont__ad__t_1af8cd2a7e0ef0f4e2c825c7812a091f9c" kindref="member">rawfp</ref>);</highlight></codeline>
<codeline lineno="753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fflush(r-&gt;<ref refid="structcont__ad__t_1af8cd2a7e0ef0f4e2c825c7812a091f9c" kindref="member">rawfp</ref>);</highlight></codeline>
<codeline lineno="754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="755"><highlight class="normal"></highlight></codeline>
<codeline lineno="756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tail<sp/>+=<sp/>l;</highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len<sp/>+=<sp/>l;</highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a7ae5362560d9edfa6c16555285487a7a" kindref="member">n_sample</ref><sp/>+=<sp/>l;</highlight></codeline>
<codeline lineno="759"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((tail<sp/>&gt;=<sp/>r-&gt;<ref refid="structcont__ad__t_1a5c6edc6be287f3ae013c59fef90cb4bd" kindref="member">adbufsize</ref>)<sp/>&amp;&amp;<sp/>(!r-&gt;<ref refid="structcont__ad__t_1af7b9044b76ed3b86ce74e4e7215ca4c3" kindref="member">eof</ref>))<sp/>{</highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tail<sp/>-=<sp/>r-&gt;<ref refid="structcont__ad__t_1a5c6edc6be287f3ae013c59fef90cb4bd" kindref="member">adbufsize</ref>;</highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(tail<sp/>&lt;<sp/>head)<sp/>{</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;adfunc)<sp/>{</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((l<sp/>=</highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(*(r-&gt;adfunc))<sp/>(r-&gt;<ref refid="structcont__ad__t_1aae5b9d977e62424b0cf0e245485b20a0" kindref="member">ad</ref>,</highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" kindref="member">adbuf</ref><sp/>+<sp/>tail,<sp/>head<sp/>-<sp/>tail))<sp/>&lt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1af7b9044b76ed3b86ce74e4e7215ca4c3" kindref="member">eof</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>l<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>l<sp/>=<sp/>head<sp/>-<sp/>tail;</highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(l<sp/>&gt;<sp/>max)</highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>l<sp/>=<sp/>max;</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(r-&gt;<ref refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" kindref="member">adbuf</ref><sp/>+<sp/>tail,<sp/>buf,<sp/>l<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(int16));</highlight></codeline>
<codeline lineno="776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((l<sp/>&gt;<sp/>0)<sp/>&amp;&amp;<sp/>r-&gt;<ref refid="structcont__ad__t_1af8cd2a7e0ef0f4e2c825c7812a091f9c" kindref="member">rawfp</ref>)<sp/>{</highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fwrite(r-&gt;<ref refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" kindref="member">adbuf</ref><sp/>+<sp/>tail,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(int16),<sp/>l,<sp/>r-&gt;<ref refid="structcont__ad__t_1af8cd2a7e0ef0f4e2c825c7812a091f9c" kindref="member">rawfp</ref>);</highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fflush(r-&gt;<ref refid="structcont__ad__t_1af8cd2a7e0ef0f4e2c825c7812a091f9c" kindref="member">rawfp</ref>);</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="781"><highlight class="normal"></highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tail<sp/>+=<sp/>l;</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len<sp/>+=<sp/>l;</highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a7ae5362560d9edfa6c16555285487a7a" kindref="member">n_sample</ref><sp/>+=<sp/>l;</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="787"><highlight class="normal"></highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>len;</highlight></codeline>
<codeline lineno="789"><highlight class="normal">}</highlight></codeline>
<codeline lineno="790"><highlight class="normal"></highlight></codeline>
<codeline lineno="791"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="792"><highlight class="comment"><sp/>*<sp/>Classify<sp/>incoming<sp/>frames<sp/>as<sp/>silence<sp/>or<sp/>speech.</highlight></codeline>
<codeline lineno="793"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="794"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="795"><highlight class="normal">cont_ad_classify(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*r,<sp/>int32<sp/>len)</highlight></codeline>
<codeline lineno="796"><highlight class="normal">{</highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>tailfrm;</highlight></codeline>
<codeline lineno="798"><highlight class="normal"></highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/>tailfrm<sp/>=<sp/>(r-&gt;<ref refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" kindref="member">headfrm</ref><sp/>+<sp/>r-&gt;<ref refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" kindref="member">n_frm</ref>);<sp/><sp/></highlight><highlight class="comment">/*<sp/>Next<sp/>free<sp/>frame<sp/>slot<sp/>to<sp/>be<sp/>filled<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(tailfrm<sp/>&gt;=<sp/>CONT_AD_ADFRMSIZE)</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tailfrm<sp/>-=<sp/>CONT_AD_ADFRMSIZE;</highlight></codeline>
<codeline lineno="802"><highlight class="normal"></highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;<sp/>len<sp/>&gt;=<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>;<sp/>len<sp/>-=<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>)<sp/>{</highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>compute_frame_pow(r,<sp/>tailfrm);</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" kindref="member">n_frm</ref>++;</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a4ed32427e6a785b571b1346c85481899" kindref="member">tot_frm</ref>++;</highlight></codeline>
<codeline lineno="807"><highlight class="normal"></highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="809"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>Find<sp/>speech/sil<sp/>state<sp/>change,<sp/>if<sp/>any.<sp/><sp/>Also,<sp/>if<sp/>staying<sp/>in<sp/>speech<sp/>state</highlight></codeline>
<codeline lineno="810"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>add<sp/>this<sp/>frame<sp/>to<sp/>current<sp/>speech<sp/>segment.</highlight></codeline>
<codeline lineno="811"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>boundary_detect(r,<sp/>tailfrm);</highlight></codeline>
<codeline lineno="813"><highlight class="normal"></highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(++tailfrm<sp/>&gt;=<sp/>CONT_AD_ADFRMSIZE)</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tailfrm<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="816"><highlight class="normal"></highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>thresholds<sp/>if<sp/>time<sp/>to<sp/>do<sp/>so<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a2168183b25add085cf3aa29ddab1c8ce" kindref="member">thresh_update</ref><sp/>&lt;=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>i,<sp/>f;</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>find_thresh(r);</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>decay_hist(r);</highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a2168183b25add085cf3aa29ddab1c8ce" kindref="member">thresh_update</ref><sp/>=<sp/>CONT_AD_THRESH_UPDATE;</highlight></codeline>
<codeline lineno="823"><highlight class="normal"></highlight></codeline>
<codeline lineno="824"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>1</highlight></codeline>
<codeline lineno="825"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="826"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>Since<sp/>threshold<sp/>has<sp/>been<sp/>updated,<sp/>recompute<sp/>r-&gt;n_other.</highlight></codeline>
<codeline lineno="827"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>(RKM:<sp/>Is<sp/>this<sp/>really<sp/>necessary?<sp/><sp/>Comment<sp/>out??)</highlight></codeline>
<codeline lineno="828"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" kindref="member">tail_state</ref><sp/>==<sp/>CONT_AD_STATE_SIL)<sp/>{</highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref>,<sp/>f<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref>;<sp/>i<sp/>&gt;<sp/>0;<sp/>--i)<sp/>{</highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" kindref="member">frm_pow</ref>[f]<sp/>&gt;=<sp/>r-&gt;<ref refid="structcont__ad__t_1a0b9333d9acc41b5bfb67f69fc22ca901" kindref="member">thresh_speech</ref>)</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref>++;</highlight></codeline>
<codeline lineno="834"><highlight class="normal"></highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f++;</highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(f<sp/>&gt;=<sp/>CONT_AD_ADFRMSIZE)</highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref>,<sp/>f<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref>;<sp/>i<sp/>&gt;<sp/>0;<sp/>--i)<sp/>{</highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" kindref="member">frm_pow</ref>[f]<sp/>&lt;=<sp/>r-&gt;<ref refid="structcont__ad__t_1adbbe28dca87d06a3ca8d2390d08ea83a" kindref="member">thresh_sil</ref>)</highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref>++;</highlight></codeline>
<codeline lineno="844"><highlight class="normal"></highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f++;</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(f<sp/>&gt;=<sp/>CONT_AD_ADFRMSIZE)</highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="850"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
<codeline lineno="851"><highlight class="preprocessor"></highlight><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="853"><highlight class="normal"></highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>r-&gt;<ref refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" kindref="member">tail_state</ref>;</highlight></codeline>
<codeline lineno="855"><highlight class="normal">}</highlight></codeline>
<codeline lineno="856"><highlight class="normal"></highlight></codeline>
<codeline lineno="857"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="858"><highlight class="comment"><sp/>*<sp/>Main<sp/>function<sp/>called<sp/>by<sp/>the<sp/>application<sp/>to<sp/>filter<sp/>out<sp/>silence<sp/>regions.</highlight></codeline>
<codeline lineno="859"><highlight class="comment"><sp/>*<sp/>Maintains<sp/>a<sp/>linked<sp/>list<sp/>of<sp/>speech<sp/>segments<sp/>pointing<sp/>into<sp/>r-&gt;adbuf<sp/>and<sp/>feeds</highlight></codeline>
<codeline lineno="860"><highlight class="comment"><sp/>*<sp/>data<sp/>to<sp/>application<sp/>from<sp/>them.</highlight></codeline>
<codeline lineno="861"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="862"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="863" refid="cont__ad_8h_1ae664132adc514db01a1d5c1209ded4ba" refkind="member"><highlight class="normal"><ref refid="cont__ad_8h_1ae664132adc514db01a1d5c1209ded4ba" kindref="member">cont_ad_read</ref>(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r,<sp/>int16<sp/>*<sp/>buf,<sp/>int32<sp/>max)</highlight></codeline>
<codeline lineno="864"><highlight class="normal">{</highlight></codeline>
<codeline lineno="865"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>flen,<sp/>len,<sp/>retval,<sp/>newstate;</highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structspseg__t" kindref="compound">spseg_t</ref><sp/>*seg;</highlight></codeline>
<codeline lineno="867"><highlight class="normal"></highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((r<sp/>==<sp/>NULL)<sp/>||<sp/>(buf<sp/>==<sp/>NULL))</highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="870"><highlight class="normal"></highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(max<sp/>&lt;<sp/>r-&gt;spf)<sp/>{</highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="err_8h_1a87a0a12135a290cf16d06b63fcfa0ccf" kindref="member">E_ERROR</ref></highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&quot;cont_ad_read<sp/>requires<sp/>buffer<sp/>of<sp/>at<sp/>least<sp/>%d<sp/>samples\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>);</highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="877"><highlight class="normal"></highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>)<sp/>{</highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>,<sp/></highlight><highlight class="stringliteral">&quot;cont_ad_read(,,<sp/>%d)\n&quot;</highlight><highlight class="normal">,<sp/>max);</highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fflush(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>);</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="882"><highlight class="normal"></highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Read<sp/>data<sp/>from<sp/>adfunc<sp/>or<sp/>from<sp/>buf.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/>len<sp/>=<sp/>cont_ad_read_internal(r,<sp/>buf,<sp/>max);</highlight></codeline>
<codeline lineno="885"><highlight class="normal"></highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Compute<sp/>frame<sp/>power<sp/>for<sp/>unprocessed+new<sp/>data<sp/>and<sp/>find<sp/>speech/silence<sp/>boundaries<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/>cont_ad_classify(r,<sp/>len);</highlight></codeline>
<codeline lineno="888"><highlight class="normal"></highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="890"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>If<sp/>eof<sp/>on<sp/>input<sp/>data<sp/>source,<sp/>cleanup<sp/>the<sp/>final<sp/>segment.</highlight></codeline>
<codeline lineno="891"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1af7b9044b76ed3b86ce74e4e7215ca4c3" kindref="member">eof</ref>)<sp/>{</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" kindref="member">tail_state</ref><sp/>==<sp/>CONT_AD_STATE_SPEECH)<sp/>{</highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="895"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>Still<sp/>inside<sp/>a<sp/>speech<sp/>segment<sp/>when<sp/>input<sp/>data<sp/>got<sp/>over.<sp/><sp/>Absort<sp/>any</highlight></codeline>
<codeline lineno="896"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>remaining<sp/>frames<sp/>into<sp/>the<sp/>final<sp/>speech<sp/>segment.</highlight></codeline>
<codeline lineno="897"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assert(r-&gt;<ref refid="structcont__ad__t_1ac77e8f8bd27cea3b99238d9663455972" kindref="member">spseg_tail</ref><sp/>!=<sp/>NULL);</highlight></codeline>
<codeline lineno="899"><highlight class="normal"></highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Absorb<sp/>frames<sp/>still<sp/>in<sp/>analysis<sp/>window<sp/>into<sp/>final<sp/>speech<sp/>seg<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assert((r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref><sp/>&gt;=<sp/>0)</highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>(r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref><sp/>&lt;<sp/>r-&gt;<ref refid="structcont__ad__t_1a7c61513f48e8fbc9ab6b57db66dad7b9" kindref="member">winsize</ref>));</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ac77e8f8bd27cea3b99238d9663455972" kindref="member">spseg_tail</ref>-&gt;nfrm<sp/>+=<sp/>r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref>;</highlight></codeline>
<codeline lineno="904"><highlight class="normal"></highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" kindref="member">tail_state</ref><sp/>=<sp/>CONT_AD_STATE_SIL;</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="907"><highlight class="normal"></highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref><sp/>+=<sp/>r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref>;</highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref><sp/>&gt;=<sp/>CONT_AD_ADFRMSIZE)</highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref><sp/>-=<sp/>CONT_AD_ADFRMSIZE;</highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="913"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="914"><highlight class="normal"></highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="916"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>At<sp/>last<sp/>ready<sp/>to<sp/>copy<sp/>speech<sp/>data,<sp/>if<sp/>any,<sp/>into<sp/>caller&apos;s<sp/>buffer.<sp/><sp/>Raw</highlight></codeline>
<codeline lineno="917"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>speech<sp/>data<sp/>is<sp/>segmented<sp/>into<sp/>alternating<sp/>speech<sp/>and<sp/>silence<sp/>segments.</highlight></codeline>
<codeline lineno="918"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>But<sp/>any<sp/>single<sp/>call<sp/>to<sp/>cont_ad_read<sp/>will<sp/>never<sp/>cross<sp/>a<sp/>speech/silence</highlight></codeline>
<codeline lineno="919"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*<sp/>boundary.</highlight></codeline>
<codeline lineno="920"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/>seg<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1abffe61140bc2a02ae4222183b3ef6159" kindref="member">spseg_head</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>first<sp/>speech<sp/>segment<sp/>available,<sp/>if<sp/>any<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="922"><highlight class="normal"></highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((seg<sp/>==<sp/>NULL)<sp/>||<sp/>(r-&gt;<ref refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" kindref="member">headfrm</ref><sp/>!=<sp/>seg-&gt;startfrm))<sp/>{</highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="925"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>Either<sp/>no<sp/>speech<sp/>data<sp/>available,<sp/>or<sp/>inside<sp/>a<sp/>silence<sp/>segment.<sp/><sp/>Find</highlight></codeline>
<codeline lineno="926"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>length<sp/>of<sp/>silence<sp/>segment.</highlight></codeline>
<codeline lineno="927"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(seg<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assert(r-&gt;<ref refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" kindref="member">tail_state</ref><sp/>==<sp/>CONT_AD_STATE_SIL);</highlight></codeline>
<codeline lineno="930"><highlight class="normal"></highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flen<sp/>=</highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(r-&gt;<ref refid="structcont__ad__t_1af7b9044b76ed3b86ce74e4e7215ca4c3" kindref="member">eof</ref>)<sp/>?<sp/>r-&gt;<ref refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" kindref="member">n_frm</ref><sp/>:<sp/>r-&gt;<ref refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" kindref="member">n_frm</ref><sp/>-<sp/>(r-&gt;<ref refid="structcont__ad__t_1a7c61513f48e8fbc9ab6b57db66dad7b9" kindref="member">winsize</ref><sp/>+</highlight></codeline>
<codeline lineno="933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a0d42e3ac6c1e5c59c86a40f4cf26a861" kindref="member">leader</ref><sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(flen<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flen<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flen<sp/>=<sp/>seg-&gt;startfrm<sp/>-<sp/>r-&gt;<ref refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" kindref="member">headfrm</ref>;</highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(flen<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flen<sp/>+=<sp/>CONT_AD_ADFRMSIZE;</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="942"><highlight class="normal"></highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a7726e8ea1bcca281a39c4b27bbb115e3" kindref="member">rawmode</ref>)<sp/>{</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Restrict<sp/>silence<sp/>segment<sp/>to<sp/>user<sp/>buffer<sp/>size,<sp/>integral<sp/>#frames<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>f<sp/>=<sp/>max<sp/>/<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>;</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(flen<sp/>&gt;<sp/>f)</highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flen<sp/>=<sp/>f;</highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="949"><highlight class="normal"></highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>newstate<sp/>=<sp/>CONT_AD_STATE_SIL;</highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flen<sp/>=<sp/>max<sp/>/<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>truncate<sp/>read-size<sp/>to<sp/>integral<sp/>#frames<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(flen<sp/>&gt;<sp/>seg-&gt;nfrm)</highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>flen<sp/>=<sp/>seg-&gt;nfrm;<sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>truncate<sp/>further<sp/>to<sp/>this<sp/>segment<sp/>size<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="956"><highlight class="normal"></highlight></codeline>
<codeline lineno="957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>newstate<sp/>=<sp/>CONT_AD_STATE_SPEECH;</highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="959"><highlight class="normal"></highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/>len<sp/>=<sp/>flen<sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>#samples<sp/>being<sp/>consumed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="961"><highlight class="normal"></highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a5524c052dcd0a3d1a1c3b1fc2134b62e" kindref="member">siglvl</ref><sp/>=<sp/>max_siglvl(r,<sp/>r-&gt;<ref refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" kindref="member">headfrm</ref>,<sp/>flen);</highlight></codeline>
<codeline lineno="963"><highlight class="normal"></highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((newstate<sp/>==<sp/>CONT_AD_STATE_SIL)<sp/>&amp;&amp;<sp/>(!r-&gt;<ref refid="structcont__ad__t_1a7726e8ea1bcca281a39c4b27bbb115e3" kindref="member">rawmode</ref>))<sp/>{</highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Skip<sp/>silence<sp/>data<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" kindref="member">headfrm</ref><sp/>+=<sp/>flen;</highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" kindref="member">headfrm</ref><sp/>&gt;=<sp/>CONT_AD_ADFRMSIZE)</highlight></codeline>
<codeline lineno="968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" kindref="member">headfrm</ref><sp/>-=<sp/>CONT_AD_ADFRMSIZE;</highlight></codeline>
<codeline lineno="969"><highlight class="normal"></highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>retval<sp/>=<sp/>0;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>#samples<sp/>being<sp/>copied/returned<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Copy<sp/>speech/silence(in<sp/>rawmode)<sp/>data<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" kindref="member">headfrm</ref><sp/>=<sp/>buf_copy(r,<sp/>r-&gt;<ref refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" kindref="member">headfrm</ref>,<sp/>flen,<sp/>buf);</highlight></codeline>
<codeline lineno="975"><highlight class="normal"></highlight></codeline>
<codeline lineno="976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>retval<sp/>=<sp/>len;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>#samples<sp/>being<sp/>copied/returned<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="977"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="978"><highlight class="normal"></highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" kindref="member">n_frm</ref><sp/>-=<sp/>flen;</highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a7ae5362560d9edfa6c16555285487a7a" kindref="member">n_sample</ref><sp/>-=<sp/>len;</highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/><sp/>assert((r-&gt;<ref refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" kindref="member">n_frm</ref><sp/>&gt;=<sp/>0)<sp/>&amp;&amp;<sp/>(r-&gt;<ref refid="structcont__ad__t_1a7ae5362560d9edfa6c16555285487a7a" kindref="member">n_sample</ref><sp/>&gt;=<sp/>0));</highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/><sp/><sp/>assert(r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref><sp/>&lt;=<sp/>r-&gt;<ref refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" kindref="member">n_frm</ref>);</highlight></codeline>
<codeline lineno="983"><highlight class="normal"></highlight></codeline>
<codeline lineno="984"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a5d9420ea711733d1eea9b8f29a638fdb" kindref="member">state</ref><sp/>==<sp/>newstate)</highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a478939247e09a8ae142c8996ec17d8c8" kindref="member">seglen</ref><sp/>+=<sp/>len;</highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a478939247e09a8ae142c8996ec17d8c8" kindref="member">seglen</ref><sp/>=<sp/>len;</highlight></codeline>
<codeline lineno="988"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a5d9420ea711733d1eea9b8f29a638fdb" kindref="member">state</ref><sp/>=<sp/>newstate;</highlight></codeline>
<codeline lineno="989"><highlight class="normal"></highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(newstate<sp/>==<sp/>CONT_AD_STATE_SPEECH)<sp/>{</highlight></codeline>
<codeline lineno="991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;startfrm<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" kindref="member">headfrm</ref>;</highlight></codeline>
<codeline lineno="992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>assert(seg-&gt;startfrm<sp/>&gt;=<sp/>0);</highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg-&gt;nfrm<sp/>-=<sp/>flen;</highlight></codeline>
<codeline lineno="994"><highlight class="normal"></highlight></codeline>
<codeline lineno="995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Free<sp/>seg<sp/>if<sp/>empty<sp/>and<sp/>not<sp/>recording<sp/>into<sp/>it<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((seg-&gt;nfrm<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;&amp;<sp/>(seg-&gt;next<sp/>||<sp/>(r-&gt;<ref refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" kindref="member">tail_state</ref><sp/>==<sp/>CONT_AD_STATE_SIL)))<sp/>{</highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1abffe61140bc2a02ae4222183b3ef6159" kindref="member">spseg_head</ref><sp/>=<sp/>seg-&gt;next;</highlight></codeline>
<codeline lineno="999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(seg-&gt;next<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ac77e8f8bd27cea3b99238d9663455972" kindref="member">spseg_tail</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(seg);</highlight></codeline>
<codeline lineno="1002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1004"><highlight class="normal"></highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Update<sp/>timestamp.<sp/><sp/>Total<sp/>raw<sp/>A/D<sp/>read<sp/>-<sp/>those<sp/>remaining<sp/>to<sp/>be<sp/>consumed<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a7b71e87abfcb3ca4ae73af34c86f955e" kindref="member">read_ts</ref><sp/>=<sp/>(r-&gt;<ref refid="structcont__ad__t_1a4ed32427e6a785b571b1346c85481899" kindref="member">tot_frm</ref><sp/>-<sp/>r-&gt;<ref refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" kindref="member">n_frm</ref>)<sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>;</highlight></codeline>
<codeline lineno="1007"><highlight class="normal"></highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(retval<sp/>==<sp/>0)</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>retval<sp/>=<sp/>(r-&gt;<ref refid="structcont__ad__t_1af7b9044b76ed3b86ce74e4e7215ca4c3" kindref="member">eof</ref><sp/>&amp;&amp;<sp/>(r-&gt;<ref refid="structcont__ad__t_1abffe61140bc2a02ae4222183b3ef6159" kindref="member">spseg_head</ref><sp/>==<sp/>NULL))<sp/>?<sp/>-1<sp/>:<sp/>0;</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"></highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref>)</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cont_ad_read_log(r,<sp/>retval);</highlight></codeline>
<codeline lineno="1013"><highlight class="normal"></highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>retval;</highlight></codeline>
<codeline lineno="1015"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"></highlight></codeline>
<codeline lineno="1017"><highlight class="normal"></highlight></codeline>
<codeline lineno="1018"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1019"><highlight class="comment"><sp/>*<sp/>Calibrate<sp/>input<sp/>channel<sp/>for<sp/>silence<sp/>threshold.</highlight></codeline>
<codeline lineno="1020"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1021"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="1022" refid="cont__ad_8h_1a7a1d0eaf8292a4549b00a97163999321" refkind="member"><highlight class="normal"><ref refid="cont__ad_8h_1a7a1d0eaf8292a4549b00a97163999321" kindref="member">cont_ad_calib</ref>(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r)</highlight></codeline>
<codeline lineno="1023"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>i,<sp/>s,<sp/>k,<sp/>len,<sp/>tailfrm;</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"></highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1028"><highlight class="normal"></highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>clear<sp/>histogram<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>CONT_AD_POWHISTSIZE;<sp/>i++)</highlight></codeline>
<codeline lineno="1031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" kindref="member">pow_hist</ref>[i]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"><sp/><sp/><sp/><sp/>tailfrm<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" kindref="member">headfrm</ref><sp/>+<sp/>r-&gt;<ref refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" kindref="member">n_frm</ref>;</highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/>if<sp/>(tailfrm<sp/>&gt;=<sp/>CONT_AD_ADFRMSIZE)</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tailfrm<sp/>-=<sp/>CONT_AD_ADFRMSIZE;</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/>s<sp/>=<sp/>(tailfrm<sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>);</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"></highlight></codeline>
<codeline lineno="1037"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1ac6e6809727ddc78a13674478d5b527db" kindref="member">n_calib_frame</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ac6e6809727ddc78a13674478d5b527db" kindref="member">n_calib_frame</ref><sp/>&lt;<sp/>CONT_AD_CALIB_FRAMES;</highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++r-&gt;<ref refid="structcont__ad__t_1ac6e6809727ddc78a13674478d5b527db" kindref="member">n_calib_frame</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>;</highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(len<sp/>&gt;<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*Trouble<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((k<sp/>=<sp/>(*(r-&gt;adfunc))<sp/>(r-&gt;<ref refid="structcont__ad__t_1aae5b9d977e62424b0cf0e245485b20a0" kindref="member">ad</ref>,<sp/>r-&gt;<ref refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" kindref="member">adbuf</ref><sp/>+<sp/>s,<sp/>len))<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>len<sp/>-=<sp/>k;</highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s<sp/>+=<sp/>k;</highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>s<sp/>-=<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>;</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"></highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>compute_frame_pow(r,<sp/>tailfrm);</highlight></codeline>
<codeline lineno="1051"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1052"><highlight class="normal"></highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a2168183b25add085cf3aa29ddab1c8ce" kindref="member">thresh_update</ref><sp/>=<sp/>CONT_AD_THRESH_UPDATE;</highlight></codeline>
<codeline lineno="1054"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>find_thresh(r);</highlight></codeline>
<codeline lineno="1055"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1056"><highlight class="normal"></highlight></codeline>
<codeline lineno="1057"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="1058" refid="cont__ad_8h_1a6a86e16fb673748be753e2a281ce837a" refkind="member"><highlight class="normal"><ref refid="cont__ad_8h_1a6a86e16fb673748be753e2a281ce837a" kindref="member">cont_ad_calib_size</ref>(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*r)</highlight></codeline>
<codeline lineno="1059"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref><sp/>*<sp/>CONT_AD_CALIB_FRAMES;</highlight></codeline>
<codeline lineno="1061"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1062"><highlight class="normal"></highlight></codeline>
<codeline lineno="1063"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="1064" refid="cont__ad_8h_1a8a575044cf22d96a5ec8fb20410b0065" refkind="member"><highlight class="normal"><ref refid="cont__ad_8h_1a8a575044cf22d96a5ec8fb20410b0065" kindref="member">cont_ad_calib_loop</ref>(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r,<sp/>int16<sp/>*<sp/>buf,<sp/>int32<sp/>max)</highlight></codeline>
<codeline lineno="1065"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1066"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>i,<sp/>s,<sp/>len,<sp/>tailfrm;</highlight></codeline>
<codeline lineno="1067"><highlight class="normal"></highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1ac6e6809727ddc78a13674478d5b527db" kindref="member">n_calib_frame</ref><sp/>==<sp/>CONT_AD_CALIB_FRAMES)<sp/>{</highlight></codeline>
<codeline lineno="1069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>If<sp/>calibration<sp/>previously<sp/>succeeded,<sp/>then<sp/>this<sp/>is<sp/>a</highlight></codeline>
<codeline lineno="1070"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*<sp/>recalibration,<sp/>so<sp/>start<sp/>again.<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ac6e6809727ddc78a13674478d5b527db" kindref="member">n_calib_frame</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>clear<sp/>histogram<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>CONT_AD_POWHISTSIZE;<sp/>i++)</highlight></codeline>
<codeline lineno="1074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" kindref="member">pow_hist</ref>[i]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1075"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1076"><highlight class="normal"></highlight></codeline>
<codeline lineno="1077"><highlight class="normal"><sp/><sp/><sp/><sp/>tailfrm<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" kindref="member">headfrm</ref><sp/>+<sp/>r-&gt;<ref refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" kindref="member">n_frm</ref>;</highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(tailfrm<sp/>&gt;=<sp/>CONT_AD_ADFRMSIZE)</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>tailfrm<sp/>-=<sp/>CONT_AD_ADFRMSIZE;</highlight></codeline>
<codeline lineno="1080"><highlight class="normal"><sp/><sp/><sp/><sp/>s<sp/>=<sp/>(tailfrm<sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>);</highlight></codeline>
<codeline lineno="1081"><highlight class="normal"></highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/><sp/><sp/>len<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>;</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;<sp/>r-&gt;<ref refid="structcont__ad__t_1ac6e6809727ddc78a13674478d5b527db" kindref="member">n_calib_frame</ref><sp/>&lt;<sp/>CONT_AD_CALIB_FRAMES;</highlight></codeline>
<codeline lineno="1084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>++r-&gt;<ref refid="structcont__ad__t_1ac6e6809727ddc78a13674478d5b527db" kindref="member">n_calib_frame</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(max<sp/>&lt;<sp/>len)</highlight></codeline>
<codeline lineno="1086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>1;</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(r-&gt;<ref refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" kindref="member">adbuf</ref><sp/>+<sp/>s,<sp/>buf,<sp/>len<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(int16));</highlight></codeline>
<codeline lineno="1088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>max<sp/>-=<sp/>len;</highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>buf<sp/>+=<sp/>len;</highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>compute_frame_pow(r,<sp/>tailfrm);</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"></highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a2168183b25add085cf3aa29ddab1c8ce" kindref="member">thresh_update</ref><sp/>=<sp/>CONT_AD_THRESH_UPDATE;</highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>find_thresh(r);</highlight></codeline>
<codeline lineno="1095"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"></highlight></codeline>
<codeline lineno="1097"><highlight class="normal"></highlight></codeline>
<codeline lineno="1098"><highlight class="normal"></highlight><highlight class="comment">/*<sp/>PWP<sp/>1/14/98<sp/>--<sp/>modified<sp/>for<sp/>compatibility<sp/>with<sp/>old<sp/>code<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1099"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="1100" refid="cont__ad_8h_1af9a8f9f66bbfd1ce48fe9366fafcc40d" refkind="member"><highlight class="normal"><ref refid="cont__ad_8h_1af9a8f9f66bbfd1ce48fe9366fafcc40d" kindref="member">cont_ad_set_thresh</ref>(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r,<sp/>int32<sp/>sil,<sp/>int32<sp/>speech)</highlight></codeline>
<codeline lineno="1101"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1102"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"></highlight></codeline>
<codeline lineno="1105"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((sil<sp/>&lt;<sp/>0)<sp/>||<sp/>(speech<sp/>&lt;<sp/>0))<sp/>{</highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(stderr,</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;cont_ad_set_thresh:<sp/>invalid<sp/>threshold<sp/>arguments:<sp/>%d,<sp/>%d\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sil,<sp/>speech);</highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a74a6f56fb4cbde7fc789c9b463cf2f8f" kindref="member">delta_sil</ref><sp/>=<sp/>(3<sp/>*<sp/>sil)<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1afca0f69a21d9f28c9610fcefc0e7cb10" kindref="member">delta_speech</ref><sp/>=<sp/>(3<sp/>*<sp/>speech)<sp/>/<sp/>2;</highlight></codeline>
<codeline lineno="1113"><highlight class="normal"></highlight></codeline>
<codeline lineno="1114"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1115"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1116"><highlight class="normal"></highlight></codeline>
<codeline lineno="1117"><highlight class="normal"></highlight></codeline>
<codeline lineno="1118"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1119"><highlight class="comment"><sp/>*<sp/>PWP<sp/>1/14/98<sp/>--<sp/>set<sp/>the<sp/>changable<sp/>params.</highlight></codeline>
<codeline lineno="1120"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="1121"><highlight class="comment"><sp/>*<sp/><sp/><sp/>delta_sil,<sp/>delta_speech,<sp/>min_noise,<sp/>and<sp/>max_noise<sp/>are<sp/>in<sp/>dB,</highlight></codeline>
<codeline lineno="1122"><highlight class="comment"><sp/>*<sp/><sp/><sp/>winsize,<sp/>speech_onset,<sp/>sil_onset,<sp/>leader<sp/>and<sp/>trailer<sp/>are<sp/>in<sp/>frames<sp/>of</highlight></codeline>
<codeline lineno="1123"><highlight class="comment"><sp/>*<sp/><sp/><sp/>16<sp/>ms<sp/>length<sp/>(256<sp/>samples<sp/>@<sp/>16kHz<sp/>sampling).</highlight></codeline>
<codeline lineno="1124"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1125"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="1126" refid="cont__ad_8h_1aa402397c575922ea352afe5e66c02a34" refkind="member"><highlight class="normal"><ref refid="cont__ad_8h_1aa402397c575922ea352afe5e66c02a34" kindref="member">cont_ad_set_params</ref>(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r,<sp/>int32<sp/>delta_sil,</highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>delta_speech,<sp/>int32<sp/>min_noise,</highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>max_noise,<sp/>int32<sp/>winsize,</highlight></codeline>
<codeline lineno="1129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>speech_onset,<sp/>int32<sp/>sil_onset,<sp/>int32<sp/>leader,</highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>trailer,<sp/>float32<sp/>adapt_rate)</highlight></codeline>
<codeline lineno="1131"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1132"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((delta_sil<sp/>&lt;<sp/>0)<sp/>||<sp/>(delta_speech<sp/>&lt;<sp/>0)<sp/>||<sp/>(min_noise<sp/>&lt;<sp/>0)</highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>(max_noise<sp/>&lt;<sp/>0))<sp/>{</highlight></codeline>
<codeline lineno="1134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="err_8h_1a87a0a12135a290cf16d06b63fcfa0ccf" kindref="member">E_ERROR</ref>(</highlight><highlight class="stringliteral">&quot;threshold<sp/>arguments:<sp/>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="stringliteral">&quot;%d,<sp/>%d,<sp/>%d,<sp/>%d<sp/>must<sp/>all<sp/>be<sp/>&gt;=0\n&quot;</highlight><highlight class="normal">,<sp/>delta_sil,</highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>delta_speech,<sp/>min_noise,<sp/>max_noise);</highlight></codeline>
<codeline lineno="1137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1138"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1139"><highlight class="normal"></highlight></codeline>
<codeline lineno="1140"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((speech_onset<sp/>&gt;<sp/>winsize)<sp/>||<sp/>(speech_onset<sp/>&lt;=<sp/>0)</highlight></codeline>
<codeline lineno="1141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>(winsize<sp/>&lt;=<sp/>0))<sp/>{</highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="err_8h_1a87a0a12135a290cf16d06b63fcfa0ccf" kindref="member">E_ERROR</ref></highlight></codeline>
<codeline lineno="1143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&quot;speech_onset,<sp/>%d,<sp/>must<sp/>be<sp/>&lt;=<sp/>winsize,<sp/>%d,<sp/>and<sp/>both<sp/>&gt;0\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>speech_onset,<sp/>winsize);</highlight></codeline>
<codeline lineno="1145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1147"><highlight class="normal"></highlight></codeline>
<codeline lineno="1148"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((sil_onset<sp/>&gt;<sp/>winsize)<sp/>||<sp/>(sil_onset<sp/>&lt;=<sp/>0)<sp/>||<sp/>(winsize<sp/>&lt;=<sp/>0))<sp/>{</highlight></codeline>
<codeline lineno="1149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="err_8h_1a87a0a12135a290cf16d06b63fcfa0ccf" kindref="member">E_ERROR</ref></highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&quot;sil_onset,<sp/>%d,<sp/>must<sp/>be<sp/>&lt;=<sp/>winsize,<sp/>%d,<sp/>and<sp/>both<sp/>&gt;0\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sil_onset,<sp/>winsize);</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1154"><highlight class="normal"></highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(((leader<sp/>+<sp/>trailer)<sp/>&gt;<sp/>winsize)<sp/>||<sp/>(leader<sp/>&lt;=<sp/>0)</highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>(trailer<sp/>&lt;=<sp/>0))<sp/>{</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="err_8h_1a87a0a12135a290cf16d06b63fcfa0ccf" kindref="member">E_ERROR</ref></highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(</highlight><highlight class="stringliteral">&quot;leader,<sp/>%d,<sp/>plus<sp/>trailer,<sp/>%d,<sp/>must<sp/>be<sp/>&lt;=<sp/>winsize,<sp/>%d,<sp/>and<sp/>both<sp/>&gt;0\n&quot;</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>leader,<sp/>trailer,<sp/>winsize);</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"></highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((adapt_rate<sp/>&lt;<sp/>0.0)<sp/>||<sp/>(adapt_rate<sp/>&gt;<sp/>1.0))<sp/>{</highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="err_8h_1a87a0a12135a290cf16d06b63fcfa0ccf" kindref="member">E_ERROR</ref>(</highlight><highlight class="stringliteral">&quot;adapt_rate,<sp/>%e;<sp/>must<sp/>be<sp/>in<sp/>range<sp/>0..1\n&quot;</highlight><highlight class="normal">,<sp/>adapt_rate);</highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1167"><highlight class="normal"></highlight></codeline>
<codeline lineno="1168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1170"><highlight class="normal"></highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a74a6f56fb4cbde7fc789c9b463cf2f8f" kindref="member">delta_sil</ref><sp/>=<sp/>delta_sil;</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1afca0f69a21d9f28c9610fcefc0e7cb10" kindref="member">delta_speech</ref><sp/>=<sp/>delta_speech;</highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ac301114b24356aef2edccba155e3cf33" kindref="member">min_noise</ref><sp/>=<sp/>min_noise;</highlight></codeline>
<codeline lineno="1174"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1af3b50663565964bb18ebb9f9e0002421" kindref="member">max_noise</ref><sp/>=<sp/>max_noise;</highlight></codeline>
<codeline lineno="1175"><highlight class="normal"></highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a7c61513f48e8fbc9ab6b57db66dad7b9" kindref="member">winsize</ref><sp/>=<sp/>winsize;</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a1b0bb7e53a2bf537ed362badddca341b" kindref="member">speech_onset</ref><sp/>=<sp/>speech_onset;</highlight></codeline>
<codeline lineno="1178"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a9f5e138f4b79b59bf4daa5603d171165" kindref="member">sil_onset</ref><sp/>=<sp/>sil_onset;</highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a0d42e3ac6c1e5c59c86a40f4cf26a861" kindref="member">leader</ref><sp/>=<sp/>leader;</highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1aa15db1e9fbb0048225521555ab8d9388" kindref="member">trailer</ref><sp/>=<sp/>trailer;</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"></highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ac22395096037175bf9a0a1f6877e5ec5" kindref="member">adapt_rate</ref><sp/>=<sp/>adapt_rate;</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"></highlight></codeline>
<codeline lineno="1184"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref><sp/>&gt;=<sp/>r-&gt;<ref refid="structcont__ad__t_1a7c61513f48e8fbc9ab6b57db66dad7b9" kindref="member">winsize</ref>)</highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref><sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a7c61513f48e8fbc9ab6b57db66dad7b9" kindref="member">winsize</ref><sp/>-<sp/>1;</highlight></codeline>
<codeline lineno="1186"><highlight class="normal"></highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1188"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1189"><highlight class="normal"></highlight></codeline>
<codeline lineno="1190"><highlight class="normal"></highlight></codeline>
<codeline lineno="1191"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1192"><highlight class="comment"><sp/>*<sp/>PWP<sp/>1/14/98<sp/>--<sp/>get<sp/>the<sp/>changable<sp/>params.</highlight></codeline>
<codeline lineno="1193"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="1194"><highlight class="comment"><sp/>*<sp/><sp/><sp/>delta_sil,<sp/>delta_speech,<sp/>min_noise,<sp/>and<sp/>max_noise<sp/>are<sp/>in<sp/>dB,</highlight></codeline>
<codeline lineno="1195"><highlight class="comment"><sp/>*<sp/><sp/><sp/>winsize,<sp/>speech_onset,<sp/>sil_onset,<sp/>leader<sp/>and<sp/>trailer<sp/>are<sp/>in<sp/>frames<sp/>of</highlight></codeline>
<codeline lineno="1196"><highlight class="comment"><sp/>*<sp/><sp/><sp/>16<sp/>ms<sp/>length<sp/>(256<sp/>samples<sp/>@<sp/>16kHz<sp/>sampling).</highlight></codeline>
<codeline lineno="1197"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1198"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="1199" refid="cont__ad_8h_1aedd013bc2c6aca14fba02049ed7645d7" refkind="member"><highlight class="normal"><ref refid="cont__ad_8h_1aedd013bc2c6aca14fba02049ed7645d7" kindref="member">cont_ad_get_params</ref>(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r,<sp/>int32<sp/>*<sp/>delta_sil,</highlight></codeline>
<codeline lineno="1200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>*<sp/>delta_speech,<sp/>int32<sp/>*<sp/>min_noise,</highlight></codeline>
<codeline lineno="1201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>*<sp/>max_noise,<sp/>int32<sp/>*<sp/>winsize,</highlight></codeline>
<codeline lineno="1202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>*<sp/>speech_onset,<sp/>int32<sp/>*<sp/>sil_onset,</highlight></codeline>
<codeline lineno="1203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32<sp/>*<sp/>leader,<sp/>int32<sp/>*<sp/>trailer,<sp/>float32<sp/>*<sp/>adapt_rate)</highlight></codeline>
<codeline lineno="1204"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1205"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!delta_sil<sp/>||<sp/>!delta_speech<sp/>||<sp/>!min_noise<sp/>||<sp/>!max_noise</highlight></codeline>
<codeline lineno="1206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>!winsize<sp/>||<sp/>!speech_onset<sp/>||<sp/>!sil_onset<sp/>||<sp/>!leader</highlight></codeline>
<codeline lineno="1207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>||<sp/>!trailer<sp/>||<sp/>!adapt_rate)<sp/>{</highlight></codeline>
<codeline lineno="1208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>fprintf(stderr,<sp/></highlight><highlight class="stringliteral">&quot;cont_ad_get_params:<sp/>some<sp/>param<sp/>slots<sp/>are<sp/>NULL\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(-1);</highlight></codeline>
<codeline lineno="1210"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1211"><highlight class="normal"></highlight></codeline>
<codeline lineno="1212"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1214"><highlight class="normal"></highlight></codeline>
<codeline lineno="1215"><highlight class="normal"><sp/><sp/><sp/><sp/>*delta_sil<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a74a6f56fb4cbde7fc789c9b463cf2f8f" kindref="member">delta_sil</ref>;</highlight></codeline>
<codeline lineno="1216"><highlight class="normal"><sp/><sp/><sp/><sp/>*delta_speech<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1afca0f69a21d9f28c9610fcefc0e7cb10" kindref="member">delta_speech</ref>;</highlight></codeline>
<codeline lineno="1217"><highlight class="normal"><sp/><sp/><sp/><sp/>*min_noise<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1ac301114b24356aef2edccba155e3cf33" kindref="member">min_noise</ref>;</highlight></codeline>
<codeline lineno="1218"><highlight class="normal"><sp/><sp/><sp/><sp/>*max_noise<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1af3b50663565964bb18ebb9f9e0002421" kindref="member">max_noise</ref>;</highlight></codeline>
<codeline lineno="1219"><highlight class="normal"></highlight></codeline>
<codeline lineno="1220"><highlight class="normal"><sp/><sp/><sp/><sp/>*winsize<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a7c61513f48e8fbc9ab6b57db66dad7b9" kindref="member">winsize</ref>;</highlight></codeline>
<codeline lineno="1221"><highlight class="normal"><sp/><sp/><sp/><sp/>*speech_onset<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a1b0bb7e53a2bf537ed362badddca341b" kindref="member">speech_onset</ref>;</highlight></codeline>
<codeline lineno="1222"><highlight class="normal"><sp/><sp/><sp/><sp/>*sil_onset<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a9f5e138f4b79b59bf4daa5603d171165" kindref="member">sil_onset</ref>;</highlight></codeline>
<codeline lineno="1223"><highlight class="normal"><sp/><sp/><sp/><sp/>*leader<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a0d42e3ac6c1e5c59c86a40f4cf26a861" kindref="member">leader</ref>;</highlight></codeline>
<codeline lineno="1224"><highlight class="normal"><sp/><sp/><sp/><sp/>*trailer<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1aa15db1e9fbb0048225521555ab8d9388" kindref="member">trailer</ref>;</highlight></codeline>
<codeline lineno="1225"><highlight class="normal"></highlight></codeline>
<codeline lineno="1226"><highlight class="normal"><sp/><sp/><sp/><sp/>*adapt_rate<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1ac22395096037175bf9a0a1f6877e5ec5" kindref="member">adapt_rate</ref>;</highlight></codeline>
<codeline lineno="1227"><highlight class="normal"></highlight></codeline>
<codeline lineno="1228"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1229"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1230"><highlight class="normal"></highlight></codeline>
<codeline lineno="1231"><highlight class="normal"></highlight></codeline>
<codeline lineno="1232"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1233"><highlight class="comment"><sp/>*<sp/>Reset,<sp/>discarded<sp/>any<sp/>accumulated<sp/>speech.</highlight></codeline>
<codeline lineno="1234"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1235"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="1236" refid="cont__ad_8h_1a12a017ea8a96dc54445e937bb9de24ae" refkind="member"><highlight class="normal"><ref refid="cont__ad_8h_1a12a017ea8a96dc54445e937bb9de24ae" kindref="member">cont_ad_reset</ref>(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r)</highlight></codeline>
<codeline lineno="1237"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1238"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structspseg__t" kindref="compound">spseg_t</ref><sp/>*seg;</highlight></codeline>
<codeline lineno="1239"><highlight class="normal"></highlight></codeline>
<codeline lineno="1240"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1242"><highlight class="normal"></highlight></codeline>
<codeline lineno="1243"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1abffe61140bc2a02ae4222183b3ef6159" kindref="member">spseg_head</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>seg<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1abffe61140bc2a02ae4222183b3ef6159" kindref="member">spseg_head</ref>;</highlight></codeline>
<codeline lineno="1245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1abffe61140bc2a02ae4222183b3ef6159" kindref="member">spseg_head</ref><sp/>=<sp/>seg-&gt;next;</highlight></codeline>
<codeline lineno="1246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(seg);</highlight></codeline>
<codeline lineno="1247"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1248"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ac77e8f8bd27cea3b99238d9663455972" kindref="member">spseg_tail</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1249"><highlight class="normal"></highlight></codeline>
<codeline lineno="1250"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1aa0617a92c549ac916258a54ec2cdc756" kindref="member">headfrm</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1251"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1abed5c6e9a2e078b70fc4c30b667612b2" kindref="member">n_frm</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1252"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a7ae5362560d9edfa6c16555285487a7a" kindref="member">n_sample</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1253"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1254"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1256"><highlight class="normal"></highlight></codeline>
<codeline lineno="1257"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" kindref="member">tail_state</ref><sp/>=<sp/>CONT_AD_STATE_SIL;</highlight></codeline>
<codeline lineno="1258"><highlight class="normal"></highlight></codeline>
<codeline lineno="1259"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1260"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1261"><highlight class="normal"></highlight></codeline>
<codeline lineno="1262"><highlight class="normal"></highlight></codeline>
<codeline lineno="1263"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="1264" refid="cont__ad_8h_1a381c3df971d43a20e8e8b8da43d2872d" refkind="member"><highlight class="normal"><ref refid="cont__ad_8h_1a381c3df971d43a20e8e8b8da43d2872d" kindref="member">cont_ad_close</ref>(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>cont)</highlight></codeline>
<codeline lineno="1265"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1266"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cont<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1268"><highlight class="normal"></highlight></codeline>
<codeline lineno="1269"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cont__ad_8h_1a12a017ea8a96dc54445e937bb9de24ae" kindref="member">cont_ad_reset</ref>(cont);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Frees<sp/>any<sp/>remaining<sp/>speech<sp/>segments<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1270"><highlight class="normal"></highlight></codeline>
<codeline lineno="1271"><highlight class="normal"><sp/><sp/><sp/><sp/>free(cont-&gt;<ref refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" kindref="member">adbuf</ref>);</highlight></codeline>
<codeline lineno="1272"><highlight class="normal"><sp/><sp/><sp/><sp/>free(cont-&gt;<ref refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" kindref="member">pow_hist</ref>);</highlight></codeline>
<codeline lineno="1273"><highlight class="normal"><sp/><sp/><sp/><sp/>free(cont-&gt;<ref refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" kindref="member">frm_pow</ref>);</highlight></codeline>
<codeline lineno="1274"><highlight class="normal"><sp/><sp/><sp/><sp/>free(cont);</highlight></codeline>
<codeline lineno="1275"><highlight class="normal"></highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1277"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1278"><highlight class="normal"></highlight></codeline>
<codeline lineno="1279"><highlight class="normal"></highlight></codeline>
<codeline lineno="1280"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="1281" refid="cont__ad_8h_1a8f8284f329d1c0e04856ec9d13020dc4" refkind="member"><highlight class="normal"><ref refid="cont__ad_8h_1a8f8284f329d1c0e04856ec9d13020dc4" kindref="member">cont_ad_detach</ref>(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>c)</highlight></codeline>
<codeline lineno="1282"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1283"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1285"><highlight class="normal"></highlight></codeline>
<codeline lineno="1286"><highlight class="normal"><sp/><sp/><sp/><sp/>c-&gt;<ref refid="structcont__ad__t_1aae5b9d977e62424b0cf0e245485b20a0" kindref="member">ad</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1287"><highlight class="normal"><sp/><sp/><sp/><sp/>c-&gt;adfunc<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1288"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1289"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1290"><highlight class="normal"></highlight></codeline>
<codeline lineno="1291"><highlight class="normal"></highlight></codeline>
<codeline lineno="1292"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="1293" refid="cont__ad_8h_1a41e7f8c5925dba26dd51e8f7a3d16404" refkind="member"><highlight class="normal"><ref refid="cont__ad_8h_1a41e7f8c5925dba26dd51e8f7a3d16404" kindref="member">cont_ad_attach</ref>(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>c,<sp/><ref refid="structad__rec__t" kindref="compound">ad_rec_t</ref><sp/>*<sp/>a,</highlight></codeline>
<codeline lineno="1294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32(*func)<sp/>(<ref refid="structad__rec__t" kindref="compound">ad_rec_t</ref><sp/>*,<sp/>int16<sp/>*,<sp/>int32))</highlight></codeline>
<codeline lineno="1295"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1296"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(c<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1298"><highlight class="normal"></highlight></codeline>
<codeline lineno="1299"><highlight class="normal"><sp/><sp/><sp/><sp/>c-&gt;<ref refid="structcont__ad__t_1aae5b9d977e62424b0cf0e245485b20a0" kindref="member">ad</ref><sp/>=<sp/>a;</highlight></codeline>
<codeline lineno="1300"><highlight class="normal"><sp/><sp/><sp/><sp/>c-&gt;adfunc<sp/>=<sp/>func;</highlight></codeline>
<codeline lineno="1301"><highlight class="normal"><sp/><sp/><sp/><sp/>c-&gt;<ref refid="structcont__ad__t_1af7b9044b76ed3b86ce74e4e7215ca4c3" kindref="member">eof</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1302"><highlight class="normal"></highlight></codeline>
<codeline lineno="1303"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1304"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1305"><highlight class="normal"></highlight></codeline>
<codeline lineno="1306"><highlight class="normal"></highlight></codeline>
<codeline lineno="1307"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="1308" refid="cont__ad_8h_1a382fe6375eae57a532c524d68bc3dd24" refkind="member"><highlight class="normal"><ref refid="cont__ad_8h_1a382fe6375eae57a532c524d68bc3dd24" kindref="member">cont_set_thresh</ref>(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r,<sp/>int32<sp/>silence,<sp/>int32<sp/>speech)</highlight></codeline>
<codeline lineno="1309"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1310"><highlight class="normal"><sp/><sp/><sp/><sp/>int32<sp/>i,<sp/>f;</highlight></codeline>
<codeline lineno="1311"><highlight class="normal"></highlight></codeline>
<codeline lineno="1312"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a0b9333d9acc41b5bfb67f69fc22ca901" kindref="member">thresh_speech</ref><sp/>=<sp/>speech;</highlight></codeline>
<codeline lineno="1313"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1adbbe28dca87d06a3ca8d2390d08ea83a" kindref="member">thresh_sil</ref><sp/>=<sp/>silence;</highlight></codeline>
<codeline lineno="1314"><highlight class="normal"></highlight></codeline>
<codeline lineno="1315"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Since<sp/>threshold<sp/>has<sp/>been<sp/>updated,<sp/>recompute<sp/>r-&gt;n_other<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1316"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1317"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" kindref="member">tail_state</ref><sp/>==<sp/>CONT_AD_STATE_SIL)<sp/>{</highlight></codeline>
<codeline lineno="1318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref>,<sp/>f<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref>;<sp/>i<sp/>&gt;<sp/>0;<sp/>--i)<sp/>{</highlight></codeline>
<codeline lineno="1319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" kindref="member">frm_pow</ref>[f]<sp/>&gt;=<sp/>r-&gt;<ref refid="structcont__ad__t_1a0b9333d9acc41b5bfb67f69fc22ca901" kindref="member">thresh_speech</ref>)</highlight></codeline>
<codeline lineno="1320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref>++;</highlight></codeline>
<codeline lineno="1321"><highlight class="normal"></highlight></codeline>
<codeline lineno="1322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f++;</highlight></codeline>
<codeline lineno="1323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(f<sp/>&gt;=<sp/>CONT_AD_ADFRMSIZE)</highlight></codeline>
<codeline lineno="1324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1326"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1327"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" kindref="member">tail_state</ref><sp/>==<sp/>CONT_AD_STATE_SPEECH)<sp/>{</highlight></codeline>
<codeline lineno="1328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a14ee16922e7287ad4ce8c51c6ddb74fc" kindref="member">win_validfrm</ref>,<sp/>f<sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1a75bc7d23bfedfd79a2fd1e3ea2188e4c" kindref="member">win_startfrm</ref>;<sp/>i<sp/>&gt;<sp/>0;<sp/>--i)<sp/>{</highlight></codeline>
<codeline lineno="1329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r-&gt;<ref refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" kindref="member">frm_pow</ref>[f]<sp/>&lt;=<sp/>r-&gt;<ref refid="structcont__ad__t_1adbbe28dca87d06a3ca8d2390d08ea83a" kindref="member">thresh_sil</ref>)</highlight></codeline>
<codeline lineno="1330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a628e5b444bde5e0eb0dc7fe8731a31a6" kindref="member">n_other</ref>++;</highlight></codeline>
<codeline lineno="1331"><highlight class="normal"></highlight></codeline>
<codeline lineno="1332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f++;</highlight></codeline>
<codeline lineno="1333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(f<sp/>&gt;=<sp/>CONT_AD_ADFRMSIZE)</highlight></codeline>
<codeline lineno="1334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>f<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1336"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1337"><highlight class="normal"></highlight></codeline>
<codeline lineno="1338"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1339"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"></highlight></codeline>
<codeline lineno="1341"><highlight class="normal"></highlight></codeline>
<codeline lineno="1342"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1343"><highlight class="comment"><sp/>*<sp/>Set<sp/>the<sp/>file<sp/>pointer<sp/>for<sp/>dumping<sp/>the<sp/>raw<sp/>input<sp/>audio<sp/>stream.</highlight></codeline>
<codeline lineno="1344"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1345"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="1346" refid="cont__ad_8h_1a662ed7c409479060e3b5ac8eb7bd1865" refkind="member"><highlight class="normal"><ref refid="cont__ad_8h_1a662ed7c409479060e3b5ac8eb7bd1865" kindref="member">cont_ad_set_rawfp</ref>(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r,<sp/>FILE<sp/>*<sp/>fp)</highlight></codeline>
<codeline lineno="1347"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1348"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1350"><highlight class="normal"></highlight></codeline>
<codeline lineno="1351"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1af8cd2a7e0ef0f4e2c825c7812a091f9c" kindref="member">rawfp</ref><sp/>=<sp/>fp;</highlight></codeline>
<codeline lineno="1352"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1353"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1354"><highlight class="normal"></highlight></codeline>
<codeline lineno="1355"><highlight class="normal"></highlight></codeline>
<codeline lineno="1356"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1357"><highlight class="comment"><sp/>*<sp/>Set<sp/>the<sp/>file<sp/>pointer<sp/>for<sp/>logging<sp/>cont_ad<sp/>progress.</highlight></codeline>
<codeline lineno="1358"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1359"><highlight class="normal">int32</highlight></codeline>
<codeline lineno="1360" refid="cont__ad_8h_1a16c5810eb19ed89522ef4c3394bbfe83" refkind="member"><highlight class="normal"><ref refid="cont__ad_8h_1a16c5810eb19ed89522ef4c3394bbfe83" kindref="member">cont_ad_set_logfp</ref>(<ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*<sp/>r,<sp/>FILE<sp/>*<sp/>fp)</highlight></codeline>
<codeline lineno="1361"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1362"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(r<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>-1;</highlight></codeline>
<codeline lineno="1364"><highlight class="normal"></highlight></codeline>
<codeline lineno="1365"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref><sp/>=<sp/>fp;</highlight></codeline>
<codeline lineno="1366"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>0;</highlight></codeline>
<codeline lineno="1367"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1368"><highlight class="normal"></highlight></codeline>
<codeline lineno="1369"><highlight class="normal"></highlight></codeline>
<codeline lineno="1370"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1371"><highlight class="comment"><sp/>*<sp/>One-time<sp/>initialization.</highlight></codeline>
<codeline lineno="1372"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1373"><highlight class="normal"><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*</highlight></codeline>
<codeline lineno="1374"><highlight class="normal"><ref refid="cont__ad_8h_1af28bf56f17d5cfebf4d960ebed44ca64" kindref="member">cont_ad_init</ref>(<ref refid="structad__rec__t" kindref="compound">ad_rec_t</ref><sp/>*<sp/>a,<sp/>int32(*func)<sp/>(<ref refid="structad__rec__t" kindref="compound">ad_rec_t</ref><sp/>*,<sp/>int16<sp/>*,<sp/>int32))</highlight></codeline>
<codeline lineno="1375"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1376"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*r;</highlight></codeline>
<codeline lineno="1377"><highlight class="normal"></highlight></codeline>
<codeline lineno="1378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((r<sp/>=<sp/>malloc(</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(*r)))<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="err_8h_1a8b8037ee64c0b344423f797589ae364f" kindref="member">E_ERROR_SYSTEM</ref>(</highlight><highlight class="stringliteral">&quot;allocation<sp/>of<sp/>cont_ad_t<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1381"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1382"><highlight class="normal"></highlight></codeline>
<codeline lineno="1383"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1aae5b9d977e62424b0cf0e245485b20a0" kindref="member">ad</ref><sp/>=<sp/>a;</highlight></codeline>
<codeline lineno="1384"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;adfunc<sp/>=<sp/>func;</highlight></codeline>
<codeline lineno="1385"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1af7b9044b76ed3b86ce74e4e7215ca4c3" kindref="member">eof</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1386"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a7726e8ea1bcca281a39c4b27bbb115e3" kindref="member">rawmode</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1387"><highlight class="normal"></highlight></codeline>
<codeline lineno="1388"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(a<sp/>!=<sp/>NULL)</highlight></codeline>
<codeline lineno="1389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a11a4bb48870007b39f8fa46e4b8f111a" kindref="member">sps</ref><sp/>=<sp/>a-&gt;<ref refid="structad__rec__t_1ac8ccccdc755f68cb4ad24007b36d6c8a" kindref="member">sps</ref>;</highlight></codeline>
<codeline lineno="1390"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a11a4bb48870007b39f8fa46e4b8f111a" kindref="member">sps</ref><sp/>=<sp/>CONT_AD_SPS;</highlight></codeline>
<codeline lineno="1392"><highlight class="normal"></highlight></codeline>
<codeline lineno="1393"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*<sp/>Set<sp/>samples/frame<sp/>such<sp/>that<sp/>when<sp/>sps=16000,<sp/>spf=256<sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1394"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref><sp/>=<sp/>(r-&gt;<ref refid="structcont__ad__t_1a11a4bb48870007b39f8fa46e4b8f111a" kindref="member">sps</ref><sp/>*<sp/>256)<sp/>/<sp/>CONT_AD_SPS;</highlight></codeline>
<codeline lineno="1395"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a5c6edc6be287f3ae013c59fef90cb4bd" kindref="member">adbufsize</ref><sp/>=<sp/>CONT_AD_ADFRMSIZE<sp/>*<sp/>r-&gt;<ref refid="structcont__ad__t_1a55f701abf33b5f68f9ef4cbf95dfaf73" kindref="member">spf</ref>;</highlight></codeline>
<codeline lineno="1396"><highlight class="normal"></highlight></codeline>
<codeline lineno="1397"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((r-&gt;<ref refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" kindref="member">adbuf</ref><sp/>=<sp/>malloc(r-&gt;<ref refid="structcont__ad__t_1a5c6edc6be287f3ae013c59fef90cb4bd" kindref="member">adbufsize</ref><sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(*r-&gt;<ref refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" kindref="member">adbuf</ref>)))<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="err_8h_1a8b8037ee64c0b344423f797589ae364f" kindref="member">E_ERROR_SYSTEM</ref>(</highlight><highlight class="stringliteral">&quot;allocation<sp/>of<sp/>audio<sp/>buffer<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(r);</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1402"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((r-&gt;<ref refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" kindref="member">pow_hist</ref><sp/>=</highlight></codeline>
<codeline lineno="1403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>calloc(CONT_AD_POWHISTSIZE,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(*r-&gt;<ref refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" kindref="member">pow_hist</ref>)))<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="err_8h_1a8b8037ee64c0b344423f797589ae364f" kindref="member">E_ERROR_SYSTEM</ref>(</highlight><highlight class="stringliteral">&quot;allocation<sp/>of<sp/>power<sp/>history<sp/>buffer<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(r-&gt;<ref refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" kindref="member">adbuf</ref>);</highlight></codeline>
<codeline lineno="1406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(r);</highlight></codeline>
<codeline lineno="1407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1408"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1409"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((r-&gt;<ref refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" kindref="member">frm_pow</ref><sp/>=</highlight></codeline>
<codeline lineno="1410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>calloc(CONT_AD_ADFRMSIZE,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(*r-&gt;<ref refid="structcont__ad__t_1a18f146239c77ff4ca6157261acdf4083" kindref="member">frm_pow</ref>)))<sp/>==<sp/>NULL)<sp/>{</highlight></codeline>
<codeline lineno="1411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="err_8h_1a8b8037ee64c0b344423f797589ae364f" kindref="member">E_ERROR_SYSTEM</ref>(</highlight><highlight class="stringliteral">&quot;allocation<sp/>of<sp/>frame<sp/>power<sp/>buffer<sp/>failed&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(r-&gt;<ref refid="structcont__ad__t_1a01f61a105019bea12533db84351d07b9" kindref="member">pow_hist</ref>);</highlight></codeline>
<codeline lineno="1413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(r-&gt;<ref refid="structcont__ad__t_1a719f5c6816cd0da0a31930a2e572b933" kindref="member">adbuf</ref>);</highlight></codeline>
<codeline lineno="1414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free(r);</highlight></codeline>
<codeline lineno="1415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1416"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1417"><highlight class="normal"></highlight></codeline>
<codeline lineno="1418"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a5d9420ea711733d1eea9b8f29a638fdb" kindref="member">state</ref><sp/>=<sp/>CONT_AD_STATE_SIL;</highlight></codeline>
<codeline lineno="1419"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a7b71e87abfcb3ca4ae73af34c86f955e" kindref="member">read_ts</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1420"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a478939247e09a8ae142c8996ec17d8c8" kindref="member">seglen</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1421"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a5524c052dcd0a3d1a1c3b1fc2134b62e" kindref="member">siglvl</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1422"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a54e2013d9634ec473aaf79a606fb2e0f" kindref="member">prev_sample</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1423"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a4ed32427e6a785b571b1346c85481899" kindref="member">tot_frm</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1424"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1af60b0f78f9959a25cf7e7bf4c4aab4d7" kindref="member">noise_level</ref><sp/>=<sp/>CONT_AD_DEFAULT_NOISE;</highlight></codeline>
<codeline lineno="1425"><highlight class="normal"></highlight></codeline>
<codeline lineno="1426"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a9e23379bf649ee06ece20133316253e5" kindref="member">auto_thresh</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1427"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a74a6f56fb4cbde7fc789c9b463cf2f8f" kindref="member">delta_sil</ref><sp/>=<sp/>CONT_AD_DELTA_SIL;</highlight></codeline>
<codeline lineno="1428"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1afca0f69a21d9f28c9610fcefc0e7cb10" kindref="member">delta_speech</ref><sp/>=<sp/>CONT_AD_DELTA_SPEECH;</highlight></codeline>
<codeline lineno="1429"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ac301114b24356aef2edccba155e3cf33" kindref="member">min_noise</ref><sp/>=<sp/>CONT_AD_MIN_NOISE;</highlight></codeline>
<codeline lineno="1430"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1af3b50663565964bb18ebb9f9e0002421" kindref="member">max_noise</ref><sp/>=<sp/>CONT_AD_MAX_NOISE;</highlight></codeline>
<codeline lineno="1431"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a7c61513f48e8fbc9ab6b57db66dad7b9" kindref="member">winsize</ref><sp/>=<sp/>CONT_AD_WINSIZE;</highlight></codeline>
<codeline lineno="1432"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a1b0bb7e53a2bf537ed362badddca341b" kindref="member">speech_onset</ref><sp/>=<sp/>CONT_AD_SPEECH_ONSET;</highlight></codeline>
<codeline lineno="1433"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a9f5e138f4b79b59bf4daa5603d171165" kindref="member">sil_onset</ref><sp/>=<sp/>CONT_AD_SIL_ONSET;</highlight></codeline>
<codeline lineno="1434"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a0d42e3ac6c1e5c59c86a40f4cf26a861" kindref="member">leader</ref><sp/>=<sp/>CONT_AD_LEADER;</highlight></codeline>
<codeline lineno="1435"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1aa15db1e9fbb0048225521555ab8d9388" kindref="member">trailer</ref><sp/>=<sp/>CONT_AD_TRAILER;</highlight></codeline>
<codeline lineno="1436"><highlight class="normal"></highlight></codeline>
<codeline lineno="1437"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1adbbe28dca87d06a3ca8d2390d08ea83a" kindref="member">thresh_sil</ref><sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1af60b0f78f9959a25cf7e7bf4c4aab4d7" kindref="member">noise_level</ref><sp/>+<sp/>r-&gt;<ref refid="structcont__ad__t_1a74a6f56fb4cbde7fc789c9b463cf2f8f" kindref="member">delta_sil</ref>;</highlight></codeline>
<codeline lineno="1438"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a0b9333d9acc41b5bfb67f69fc22ca901" kindref="member">thresh_speech</ref><sp/>=<sp/>r-&gt;<ref refid="structcont__ad__t_1af60b0f78f9959a25cf7e7bf4c4aab4d7" kindref="member">noise_level</ref><sp/>+<sp/>r-&gt;<ref refid="structcont__ad__t_1afca0f69a21d9f28c9610fcefc0e7cb10" kindref="member">delta_speech</ref>;</highlight></codeline>
<codeline lineno="1439"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a2168183b25add085cf3aa29ddab1c8ce" kindref="member">thresh_update</ref><sp/>=<sp/>CONT_AD_THRESH_UPDATE;</highlight></codeline>
<codeline lineno="1440"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ac22395096037175bf9a0a1f6877e5ec5" kindref="member">adapt_rate</ref><sp/>=<sp/>CONT_AD_ADAPT_RATE;</highlight></codeline>
<codeline lineno="1441"><highlight class="normal"></highlight></codeline>
<codeline lineno="1442"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ae52185e7f7dfe424060c0ff562a8858b" kindref="member">tail_state</ref><sp/>=<sp/>CONT_AD_STATE_SIL;</highlight></codeline>
<codeline lineno="1443"><highlight class="normal"></highlight></codeline>
<codeline lineno="1444"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1abffe61140bc2a02ae4222183b3ef6159" kindref="member">spseg_head</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1445"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ac77e8f8bd27cea3b99238d9663455972" kindref="member">spseg_tail</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1446"><highlight class="normal"></highlight></codeline>
<codeline lineno="1447"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1af8cd2a7e0ef0f4e2c825c7812a091f9c" kindref="member">rawfp</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1448"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1adbbb6765386309476549beb058a235c5" kindref="member">logfp</ref><sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1449"><highlight class="normal"></highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1ac6e6809727ddc78a13674478d5b527db" kindref="member">n_calib_frame</ref><sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1451"><highlight class="normal"></highlight></codeline>
<codeline lineno="1452"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="cont__ad_8h_1a12a017ea8a96dc54445e937bb9de24ae" kindref="member">cont_ad_reset</ref>(r);</highlight></codeline>
<codeline lineno="1453"><highlight class="normal"></highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>r;</highlight></codeline>
<codeline lineno="1455"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1456"><highlight class="normal"></highlight></codeline>
<codeline lineno="1457"><highlight class="normal"></highlight></codeline>
<codeline lineno="1458"><highlight class="normal"><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*</highlight></codeline>
<codeline lineno="1459"><highlight class="normal"><ref refid="cont__ad_8h_1a1a9bbf961917827f5d03adcd409dda35" kindref="member">cont_ad_init_rawmode</ref>(<ref refid="structad__rec__t" kindref="compound">ad_rec_t</ref><sp/>*<sp/>a,</highlight></codeline>
<codeline lineno="1460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>int32(*func)<sp/>(<ref refid="structad__rec__t" kindref="compound">ad_rec_t</ref><sp/>*,<sp/>int16<sp/>*,<sp/>int32))</highlight></codeline>
<codeline lineno="1461"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1462"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="structcont__ad__t" kindref="compound">cont_ad_t</ref><sp/>*r;</highlight></codeline>
<codeline lineno="1463"><highlight class="normal"></highlight></codeline>
<codeline lineno="1464"><highlight class="normal"><sp/><sp/><sp/><sp/>r<sp/>=<sp/><ref refid="cont__ad_8h_1af28bf56f17d5cfebf4d960ebed44ca64" kindref="member">cont_ad_init</ref>(a,<sp/>func);</highlight></codeline>
<codeline lineno="1465"><highlight class="normal"><sp/><sp/><sp/><sp/>r-&gt;<ref refid="structcont__ad__t_1a7726e8ea1bcca281a39c4b27bbb115e3" kindref="member">rawmode</ref><sp/>=<sp/>1;</highlight></codeline>
<codeline lineno="1466"><highlight class="normal"></highlight></codeline>
<codeline lineno="1467"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>r;</highlight></codeline>
<codeline lineno="1468"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="/home/gpuser/cmusphinx-code/sphinxbase/src/libsphinxad/cont_ad_base.c"/>
  </compounddef>
</doxygen>
